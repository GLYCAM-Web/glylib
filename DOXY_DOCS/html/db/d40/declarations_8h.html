<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: inc/declarations.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">inc</a></div>
<h1>declarations.h File Reference</h1>
<p>
This graph shows which files directly or indirectly include this file:<p><center><img src="../../d3/d3e/declarations_8h__dep__incl.png" border="0" usemap="#declarations.hdep_map" alt="Included by dependency graph"></center>
<map name="declarations.hdep_map">
<area href="../../dd/d4e/load__atypes_8c.html" shape="rect" coords="5,5,109,32" alt="">
<area href="../../d2/dc6/load__dlg__mol_8c.html" shape="rect" coords="133,5,243,32" alt="">
<area href="../../da/d0c/read__prep_8c.html" shape="rect" coords="267,5,357,32" alt="">
</map>

<p>
<a href="../../d9/dc7/declarations_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../de/da3/structdockinfo.html">dockinfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/declarations_8h.html#a0">load_dlg_mol</a> (<a class="el" href="../../dc/d59/structfileset.html">fileset</a> F, <a class="el" href="../../dc/d7a/structatype.html">atype</a> *AT)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/declarations_8h.html#a1">load_atypes</a> (<a class="el" href="../../dc/d59/structfileset.html">fileset</a> FT, <a class="el" href="../../d5/de2/structtypes.html">types</a> *T)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a1" doxytag="declarations.h::load_atypes"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void load_atypes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d59/structfileset.html">fileset</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FT</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/de2/structtypes.html">types</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2d/load__atypes_8c-source.html#l00015">15</a> of file <a class="el" href="../../d7/d2d/load__atypes_8c-source.html">load_atypes.c</a>.
<p>
References <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00108">types::a</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00053">atype::bo</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00051">atype::desc</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00028">fileset::F</a>, <a class="el" href="../../d7/d04/load__pdb_8h-source.html#l00021">line</a>, <a class="el" href="../../d9/dc2/myfopen_8c-source.html#l00025">myfreopen()</a>, <a class="el" href="../../d7/d30/mywhine_8c-source.html#l00007">mywhine()</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00027">fileset::N</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00048">atype::N</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00107">types::na</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00052">atype::nb</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00049">atype::NT</a>, and <a class="el" href="../../d8/d4d/read__eek_8c-source.html#l00006">read_eek()</a>.<div class="fragment"><pre class="fragment">00015                                      {
00016 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#a4">line</a>[10001],*entry;
00017 <span class="keywordtype">int</span> test=0,la=0,numbnd=0;
00018 F.F=<a class="code" href="../../de/de6/myfopen_8c.html#a1">myfreopen</a>(F.N,<span class="stringliteral">"r"</span>,F.F); <span class="comment">// don't depend on calling function to have opened</span>
00019 <span class="keywordflow">while</span>(fgets(line,10000,F.F)!=NULL){<span class="comment">// while not end of file</span>
00020         <span class="keywordflow">if</span>(<a class="code" href="../../d7/d40/load__pdb_8h.html#a4">line</a>[0]!=<span class="charliteral">'#'</span>){<span class="comment">//check that the line does not start with a hash </span>
00021                 <span class="keywordflow">if</span>(strchr(line,EOF)!=NULL){<a class="code" href="../../d9/dd3/read__eek_8c.html#a0">read_eek</a>(<span class="stringliteral">"EOF"</span>,F.N);}
00022                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>++;<span class="comment">// increment and allocate</span>
00023                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>=(<a class="code" href="../../dc/d7a/structatype.html">atype</a>*)realloc(T[0].a,T[0].na*<span class="keyword">sizeof</span>(<a class="code" href="../../dc/d7a/structatype.html">atype</a>));
00024                 <span class="comment">// read data into structure by splitting on the : token</span>
00025                 <span class="comment">//strcpy(entry,strtok(line,":")); // get atomic number</span>
00026                 test=sscanf(strtok(line,<span class="stringliteral">":"</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].n);
00027                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading atomic number"</span>);}
00028                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo1">N</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get atom name</span>
00029                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo2">NT</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get element name</span>
00030                 <span class="comment">//strcpy(entry,strtok(NULL,":")); // get mass</span>
00031                 test=sscanf(strtok(NULL,<span class="stringliteral">":"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].m);
00032                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading atomic mass"</span>);}
00033                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo4">desc</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get description </span>
00034                 entry=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get bonding info </span>
00035                 test=sscanf(strtok(NULL,<span class="stringliteral">":"</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].nlp);<span class="comment">// get number lone pairs</span>
00036                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading number of lone pairs"</span>);}
00037                 <span class="comment">// split bonding info</span>
00038                 <span class="keywordflow">if</span>(strchr(entry,<span class="charliteral">'('</span>)==NULL){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: bonding field does not contain bond orders"</span>);}
00039                 test=sscanf(strtok(entry,<span class="stringliteral">"("</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].nb);<span class="comment">// get number typical bonds</span>
00040                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading number of typical bonds"</span>);}
00041                 numbnd=T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo5">nb</a>;
00042                 <span class="keywordflow">if</span>(numbnd==0){
00043                         numbnd=1;
00044                         T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>=(<span class="keywordtype">double</span>*)calloc(1,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00045                         test=sscanf(strtok(NULL,<span class="stringliteral">",)"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].bo[0]);<span class="comment">// get bond order</span>
00046                         <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading bond order"</span>);}
00047                         <span class="keywordflow">if</span>(T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>[0]!=0) T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo5">nb</a>=-1;
00048                         }
00049                 <span class="keywordflow">else</span>{
00050                         T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>=(<span class="keywordtype">double</span>*)calloc(numbnd,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00051                         <span class="keywordflow">for</span>(la=0;la&lt;numbnd;la++){
00052                                 test=sscanf(strtok(NULL,<span class="stringliteral">",)"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].bo[la]);<span class="comment">// get bond order</span>
00053                                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading bond order"</span>);}
00054                                 } 
00055                         }
00056                 } <span class="comment">// close if line is not a comment</span>
00057         }<span class="comment">// close while not EOF</span>
00058 <span class="comment">// return; </span>
00059 <span class="keywordflow">return</span>;
00060 }
</pre></div>
<p>
    </td>
  </tr>
</table>

<p>
Here is the call graph for this function:<p><center><img src="../../db/d40/declarations_8h_a1_cgraph.png" border="0" usemap="#db/d40/declarations_8h_a1_cgraph_map" alt=""></center>
<map name="db/d40/declarations_8h_a1_cgraph_map">
<area href="../../de/de6/myfopen_8c.html#a1" shape="rect" coords="148,5,231,32" alt="">
<area href="../../d9/d66/mywhine_8c.html#a0" shape="rect" coords="153,56,225,83" alt="">
<area href="../../d9/dd3/read__eek_8c.html#a0" shape="rect" coords="151,107,228,133" alt="">
</map>
<a class="anchor" name="a0" doxytag="declarations.h::load_dlg_mol"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/da3/structdockinfo.html">dockinfo</a>* load_dlg_mol           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d59/structfileset.html">fileset</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../dc/d7a/structatype.html">atype</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>AT</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/daf/load__dlg__mol_8c-source.html#l00015">15</a> of file <a class="el" href="../../d8/daf/load__dlg__mol_8c-source.html">load_dlg_mol.c</a>.
<p>
References <a class="el" href="../../da/dff/molecules_8h-source.html#l00175">residue::a</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00221">molecule::boxh</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00221">molecule::boxl</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00178">residue::bs</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00208">molecule::COM</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00174">residue::COM</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00168">residue::D</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00190">residue::d</a>, <a class="el" href="../../d8/d40/dprint__X_8c-source.html#l00160">dprint_molecule()</a>, <a class="el" href="../../d0/da7/dXprint__X_8c-source.html#l00023">dXprint_coord_3D()</a>, <a class="el" href="../../d0/da7/dXprint__X_8c-source.html#l00119">dXprint_molecule()</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00243">dockinfo::eFEB</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00244">dockinfo::eKi</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00028">fileset::F</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00245">dockinfo::fDE</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00246">dockinfo::fIE</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00247">dockinfo::fIEL</a>, <a class="el" href="../../d2/dc9/geometries_8h-source.html#l00009">coord_3D::i</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00188">residue::i</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00236">dockinfo::i</a>, <a class="el" href="../../d2/dc9/geometries_8h-source.html#l00009">coord_3D::j</a>, <a class="el" href="../../d2/dc9/geometries_8h-source.html#l00009">coord_3D::k</a>, <a class="el" href="../../d7/d04/load__pdb_8h-source.html#l00021">line</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00251">dockinfo::M</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00173">residue::m</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00204">molecule::m</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00050">atype::m</a>, <a class="el" href="../../d7/d30/mywhine_8c-source.html#l00007">mywhine()</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00027">fileset::N</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00167">residue::N</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00166">residue::n</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00133">atom::n</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00134">atom::N</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00048">atype::N</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00237">dockinfo::n</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00209">molecule::na</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00172">residue::na</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00145">atom::nalt</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00140">atom::nb</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00177">residue::nbs</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00189">residue::nd</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00187">residue::ni</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00151">atom::ni</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00142">atom::nmb</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00212">molecule::nr</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00179">residue::nr</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00180">residue::nrbs</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00182">residue::nrc</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00219">molecule::nrc</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00184">residue::nrp</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00049">atype::NT</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00147">atom::nvec</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00195">residue::nVP</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00239">dockinfo::Q</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00239">dockinfo::QN</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00239">dockinfo::QN0</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00213">molecule::r</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00181">residue::rbs</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00183">residue::rc</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00220">molecule::rc</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00238">dockinfo::RC</a>, <a class="el" href="../../d8/d4d/read__eek_8c-source.html#l00006">read_eek()</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00185">residue::rp</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00137">atom::t</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00248">dockinfo::TFE</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00244">dockinfo::Tmp</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00238">dockinfo::TR</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00196">residue::VP</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00144">atom::x</a>, and <a class="el" href="../../da/dff/molecules_8h-source.html#l00146">atom::xa</a>.<div class="fragment"><pre class="fragment">00015                                            {
00016 <span class="keywordtype">int</span> a=0,b=-1000,anum=0,rnum=0,ndock=0,ai=0,di=0,ri=0,ti=0;
00017 <span class="keywordtype">int</span> scntst=0,*AI,nat=0,localdebug=1;
00018 <span class="keywordtype">int</span> fRes = -1;
00019 fpos_t* start = (fpos_t*)calloc(1,<span class="keyword">sizeof</span>(fpos_t));
00020 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#a4">line</a>[501],dum1[50],dum2[50],at[10],res[10]; <span class="comment">// maybe no lines longer than 500...</span>
00021 <span class="keywordtype">char</span> whinetext[501];
00022 <span class="keywordtype">double</span> x=0,y=0,z=0,xl=0,xh=0,yl=0,yh=0,zl=0,zh=0;
00023 <a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a> *D;
00024 
00025 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: At top.\n"</span>);}
00026 <span class="comment">// initialize some stuff</span>
00027 D=(<a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a>));
00028 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>=1;
00029 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>=0;
00030 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>=(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>));
00031 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>=0;
00032 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>));
00033 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>=0;
00034 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>=0;
00035 <span class="keywordflow">if</span>(localdebug&gt;1){<a class="code" href="../../da/d70/dprint__X_8c.html#a8">dprint_molecule</a>(&amp;D[0].M,10);}
00036 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: After init.\n"</span>);}
00037 rewind(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00038 <span class="comment">// find the start of the input PDBQ file</span>
00039 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00040 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"line is &gt;&gt;&gt;%s&lt;&lt;&lt;\n"</span>,line);}
00041         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"INPUT PDBQ FILE"</span>)!=NULL){
00042                 fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00043                 fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00044                 <span class="keywordflow">break</span>;
00045                 }}
00046 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: After found PDBQ.\n"</span>);}
00047 <span class="comment">//Find the smallest residue number</span>
00048 fgetpos(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>,start);
00049 <span class="keywordflow">while</span>(strstr(line,<span class="stringliteral">"__________________________________"</span>) == NULL){
00050         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"INPUT-PDBQ: ATOM"</span>)!=NULL){
00051                 scntst=sscanf(line,<span class="stringliteral">"%s %s %d %s %s %d"</span>,dum1,dum2,&amp;anum,at,res,&amp;rnum);
00052                 <span class="keywordflow">if</span>(rnum &lt; fRes || fRes &lt; 0)
00053                         fRes = rnum;
00054         }
00055         fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00056 }
00057 fRes -= 1;
00058 fsetpos(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>,start);
00059 free(start);
00060 <span class="comment">// read in the PDBQ info to the structure</span>
00061 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00062 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"load_dlg_mol: Reading file.\n"</span>);}
00063 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"line is &gt;&gt;&gt;%s&lt;&lt;&lt;\n"</span>,line);}
00064         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"INPUT-PDBQ"</span>)!=NULL){
00065 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"load_dlg_mol: Reading PDBQ.\n"</span>);}
00066                 <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"INPUT-PDBQ: ATOM"</span>)!=NULL){
00067                         scntst=sscanf(line,<span class="stringliteral">"%s %s %d %s %s %d %lf %lf %lf"</span>,\
00068                                 dum1,dum2,&amp;anum,at,res,&amp;rnum,&amp;x,&amp;y,&amp;z);
00069 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"line is &gt;&gt;&gt;%s&lt;&lt;&lt;\n"</span>,line);}
00070                         rnum-=fRes;
00071                         <span class="keywordflow">if</span>(scntst!=9){<a class="code" href="../../d9/dd3/read__eek_8c.html#a0">read_eek</a>(<span class="stringliteral">"end of line while reading INPUT-PDBQ: ATOM"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);}
00072                         <span class="keywordflow">if</span>(b==-1000){
00073                                 xl=xh=x; 
00074                                 yl=yh=y; 
00075                                 zl=zh=z; 
00076                                 b=0;
00077                                 }
00078                         <span class="keywordflow">else</span>{
00079                                 <span class="keywordflow">if</span>(x&lt;xl){xl=x;}
00080                                 <span class="keywordflow">if</span>(x&gt;xh){xh=x;}
00081                                 <span class="keywordflow">if</span>(y&lt;yl){yl=y;}
00082                                 <span class="keywordflow">if</span>(y&gt;yh){yh=y;}
00083                                 <span class="keywordflow">if</span>(z&lt;zl){zl=z;}
00084                                 <span class="keywordflow">if</span>(z&gt;zh){zh=z;}
00085                                 }
00086                         <span class="keywordflow">if</span>(rnum&gt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>){
00087 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: need more space for rnum -- assigning\n"</span>);}
00088                                 ri=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>; <span class="comment">// number already allocated</span>
00089                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>=rnum;
00090                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>=(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>*)realloc(D[0].M.r,rnum*<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>));
00091                                 <span class="keywordflow">for</span>(b=ri;b&lt;rnum;b++){
00092                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>=0;
00093                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>=0;
00094                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo1">N</a> = (<span class="keywordtype">char</span>*)calloc(11,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
00095                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo2">D</a> = NULL;
00096                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo12">bs</a> = NULL;
00097                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo15">rbs</a> = NULL;
00098                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a> = NULL;
00099                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo19">rp</a> = NULL;
00100                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo21">i</a> = NULL;
00101                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo23">d</a> = NULL;
00102                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo29">VP</a> = NULL;
00103                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo1">N</a>[0]=<span class="charliteral">'\0'</span>;
00104                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo22">nd</a> = 0;
00105                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo20">ni</a> = 0;
00106                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo13">nr</a> = 0;
00107                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo18">nrp</a> = 0;
00108                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo16">nrc</a> = 0;
00109                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo14">nrbs</a> = 0;
00110                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo11">nbs</a> = 0;
00111                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo28">nVP</a> = 0;
00112                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>)); 
00113                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo18">ni</a>=0;
00114                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo7">nb</a>=0;
00115                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo9">nmb</a>=0;
00116                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo12">nalt</a>=0;
00117                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo14">nvec</a>=0;
00118                                         }
00119 <span class="comment">//if(localdebug&gt;1){dprint_molecule(&amp;D[0].M,10);}</span>
00120                                 }
00121                         ri=rnum-1;
00122                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo0">n</a>=rnum+fRes;<span class="comment">//Set the residue number</span>
00123 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: ri is %d ; D[0].M.r[ri].N is &gt;&gt;%s&lt;&lt;\n"</span>,ri,D[0].M.r[ri].N);}
00124                         <span class="comment">//if(D[0].M.r[ri].na==0){ strcpy(D[0].M.r[ri].N,res); }</span>
00125                         <span class="keywordflow">if</span>(D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>==0){ D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo1">N</a> = strdup(res); }
00126                         <span class="keywordflow">else</span>{<span class="keywordflow">if</span>(strcmp(D[0].M.r[ri].N,res)!=0){
00127                                 sprintf(whinetext,<span class="stringliteral">"residue name mismatch reading initial PDBQ\n\</span>
00128 <span class="stringliteral">between read residue &gt;&gt;%s&lt;&lt; and comparison residue (D[0].M.r[%d].N &gt;&gt;%s&lt;&lt;)"</span>,res,ri,D[0].M.r[ri].N);
00129                                 <a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(whinetext);}}
00130                         ai=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>; <span class="comment">// atom index, for convenience</span>
00131                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>++;
00132                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>++;
00133                         <span class="keywordflow">if</span>(anum&gt;nat){nat=anum;}; <span class="comment">// overall atom count</span>
00134                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>*)realloc(D[0].M.r[ri].a,(ai+1)*<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>));
00135                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo18">ni</a>=0;
00136                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo7">nb</a>=0;
00137                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo9">nmb</a>=0;
00138                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo12">nalt</a>=0;
00139                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo14">nvec</a>=0;
00140                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>=anum;
00141                         <span class="comment">//strcpy(D[0].M.r[ri].a[ai].N,at);</span>
00142                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo1">N</a> = strdup(at);
00143 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: ri is %d ; ai is %d ; D[0].M.r[ri].a[ai].N is &gt;&gt;%s&lt;&lt;\n"</span>,ri,ai,D[0].M.r[ri].a[ai].N);}
00144                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=x;
00145                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=y;
00146                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=z;
00147                         <span class="keywordflow">for</span>(b=0;b&lt;NUMAT;b++){ <span class="comment">// might be a problem, the NUMAT(fixed)</span>
00148                                 <span class="keywordflow">if</span>(at[0]==AT[b].<a class="code" href="../../dc/d7a/structatype.html#atypeo2">NT</a>[0]){
00149                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo4">t</a>=b;
00150                                         ti=b; <span class="comment">// for convenience</span>
00151                                         <span class="keywordflow">break</span>;
00152                                         }
00153                                 }
00154                         <span class="comment">// add to the COM determinations</span>
00155                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>+=AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// add to molecule MW</span>
00156                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// molecule COM</span>
00157                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00158                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00159                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>+=AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// add to residue MW</span>
00160                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// residue COM</span>
00161                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00162                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00163 <span class="keywordflow">if</span>(localdebug&gt;1){printf(<span class="stringliteral">"\tload_dlg_mol: ri = %d ; ai = %d (%s) type %s mass %f  (running= %f )\n"</span>,ri,ai,D[0].M.r[ri].a[ai].N,AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo1">N</a>,AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>);}
00164 <span class="keywordflow">if</span>(localdebug&gt;1){printf(<span class="stringliteral">"\tload_dlg_mol: res main x y z is %20.15e  %20.15e  %20.15e \n"</span>,D[0].M.r[ri].a[ai].x.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);}
00165 <span class="keywordflow">if</span>(localdebug&gt;1){printf(<span class="stringliteral">"\tload_dlg_mol: running COM is %20.15e  %20.15e  %20.15e \n"</span>,D[0].M.r[ri].COM.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);}
00166                         }
00167 <span class="comment">//if(localdebug&gt;1){dprint_molecule(&amp;D[0].M,10);}</span>
00168                 }
00169         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Number of atoms found in molecule"</span>)!=NULL){<span class="keywordflow">break</span>;} 
00170         }
00171 <span class="comment">// ONE DAY:  add in any missing atoms</span>
00172 <span class="comment">// -- open the prep database</span>
00173 <span class="comment">// -- scan for the residue name</span>
00174 <span class="comment">// -- record number/name/type of atoms</span>
00175 <span class="comment">// -- mark as present or not, etc...</span>
00176 <span class="comment">//</span>
00177 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: About to start COM calc.\n"</span>);}
00178 <span class="comment">// finish COM calculation for molecule</span>
00179 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00180 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00181 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00182 <span class="comment">//printf("center of mass (MW=%20.12e) is at: %20.12e %20.12e %20.12e \n",D[0].M.COM.i,D[0].M.COM.j,D[0].M.COM.k);</span>
00183 <span class="comment">// also for the residues -- plus record atom number correlation</span>
00184 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: continuing residue-level COM calc.\n"</span>);}
00185 AI=(<span class="keywordtype">int</span>*)calloc(nat,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
00186 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){ 
00187         <span class="keywordflow">if</span>(D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>==0){
00188                 sprintf(whinetext,<span class="stringliteral">"lack of atoms in residue &gt;&gt;%s&lt;&lt;, number %d"</span>,D[0].M.r[a].N,(a+1));
00189                 <a class="code" href="../../d9/dd3/read__eek_8c.html#a0">read_eek</a>(whinetext,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);
00190                 }
00191         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00192         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00193         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00194 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"\tload_dlg_mol: about to set ai indices.\n"</span>);}
00195         <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>;b++){
00196                 <span class="keywordflow">if</span>(D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>&gt;nat){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"problem counting atoms (n) in load_dlg"</span>);}
00197                 AI[D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>-1]=b;
00198                 }
00199         }
00200 
00201 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: Scanning to dockings.\n"</span>);}
00202 <span class="comment">// read in the alternate coordinate sets</span>
00203 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00204         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Number of requested LGA dockings"</span>)!=NULL){
00205 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"load_dlg_mol: line is &gt;&gt;%s&lt;&lt;\n"</span>,line);} 
00206                 sscanf(line,<span class="stringliteral">"Number of requested LGA dockings = %d "</span>,&amp;ndock);
00207 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: ndock is &gt;&gt;%d&lt;&lt;\n"</span>,ndock);} 
00208                 <span class="keywordflow">break</span>; }}
00209 <span class="comment">// allocate the memory -- use the internal ring coordinates to hold</span>
00210 <span class="comment">// the extra centers of mass</span>
00211 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: About to allocate; ndock is %d.\n"</span>,ndock);}
00212 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>=0;
00213 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo1">n</a>=ndock;
00214 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo3">TR</a>=(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>));<span class="comment">//translation for docked structure</span>
00215 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo4">Q</a>=(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>));<span class="comment">// Quaternion x,y,z,w</span>
00216 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo5">QN</a>=(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>));<span class="comment">// Quaternion nx,ny,nz,angle</span>
00217 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo6">QN0</a>=(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>));<span class="comment">// quat0 nx,ny,nz,angle</span>
00218 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo9">eFEB</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// Est. Free Energy of Binding, kcal/mol [=(1)+(3)]</span>
00219 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo10">eKi</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// Est. Inhibition Const. Ki </span>
00220 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo11">Tmp</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// temperature, Kelvin</span>
00221 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo12">fDE</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// Final Docked Energy, kcal/mol [=(1)+(2)]</span>
00222 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo13">fIE</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// (1) Final Intermolecular Energy</span>
00223 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo14">fIEL</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// (2) Final Internal Energy of Ligand</span>
00224 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo15">TFE</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// (3) Torsional Free Energy </span>
00225 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo18">nrc</a>=ndock;
00226 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>=(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>)); <span class="comment">// for alt struct mol COM's</span>
00227 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){
00228         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo16">nrc</a>=ndock;
00229         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>=(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>)); <span class="comment">// for alt struct res COM's</span>
00230         <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>;b++){
00231                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo12">nalt</a>=ndock;
00232                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>=(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>));
00233                 }
00234         }
00235 
00236 
00237 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: About to read alternate sets.\n"</span>);}
00238 <span class="comment">// read in the docked structures</span>
00239 di=-1; <span class="comment">// index to check that all docked structures were found</span>
00240 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00241         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"FINAL LAMARCKIAN GENETIC ALGORITHM DOCKED STATE"</span>)!=NULL){
00242 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; about to read energy info.\n"</span>);}
00243         di++;
00244         <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00245                 <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"DOCKED: USER                           _______"</span>)!=NULL){<span class="keywordflow">break</span>;}
00246                 <span class="keywordflow">else</span>{
00247                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Quaternion nx,ny,nz,angle"</span>)!=NULL){
00248                                 sscanf(line,<span class="stringliteral">"%s %s %s %lf %lf %lf %lf"</span>,dum1,dum1,dum1,\
00249                                         &amp;D[0].QN[di].i,&amp;D[0].QN[di].j,&amp;D[0].QN[di].k,&amp;D[0].QN[di].d); 
00250                                 }
00251                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Quaternion x,y,z,w "</span>)!=NULL){
00252                                 sscanf(line,<span class="stringliteral">"%s %s %s %lf %lf %lf %lf"</span>,dum1,dum1,dum1,\
00253                                         &amp;D[0].Q[di].i,&amp;D[0].Q[di].j,&amp;D[0].Q[di].k,&amp;D[0].Q[di].d); 
00254                                 }
00255                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Estimated Free Energy of Binding "</span>)!=NULL){
00256                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,\
00257                                         dum1,dum1,dum1,dum1,&amp;D[0].eFEB[di]);
00258                                 }
00259                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Estimated Inhibition Constant, Ki"</span>)!=NULL){
00260                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %s %s %s %lf %s %s %lf"</span>,dum1,dum1,dum1,dum1,\
00261                                         dum1,dum1,dum1,&amp;D[0].eKi[di],dum1,dum1,&amp;D[0].Tmp[di]);
00262                                 }
00263                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Final Docked Energy"</span>)!=NULL){
00264                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,dum1,dum1,\
00265                                         &amp;D[0].fDE[di]);
00266                                 }
00267                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Final Intermolecular Energy"</span>)!=NULL){
00268                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,dum1,\
00269                                         dum1,dum1,&amp;D[0].fIE[di]);
00270                                 }
00271                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Final Internal Energy of Ligand"</span>)!=NULL){
00272                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,\
00273                                         dum1,dum1,dum1,dum1,dum1,dum1,&amp;D[0].fIEL[di]);
00274                                 }
00275                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"Torsional Free Energy"</span>)!=NULL){
00276                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,\
00277                                         dum1,dum1,dum1,&amp;D[0].TFE[di]);
00278                                 }
00279                         <span class="keywordflow">if</span>((strstr(line,<span class="stringliteral">"NEWDPF about"</span>)!=NULL)&amp;&amp;(di==0)){
00280                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %lf %lf %lf"</span>,dum1,dum1,dum1,dum1,\
00281                                         &amp;D[0].RC.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,&amp;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo2">RC</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,&amp;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo2">RC</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>); 
00282                                 }
00283                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"NEWDPF tran0 "</span>)!=NULL){
00284                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %lf %lf %lf"</span>,dum1,dum1,dum1,dum1,\
00285                                         &amp;D[0].TR[di].i,&amp;D[0].TR[di].j,&amp;D[0].TR[di].k);
00286                                 }
00287                         <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"NEWDPF quat0"</span>)!=NULL){
00288                                 sscanf(line,<span class="stringliteral">"%s %s %s %s %lf %lf %lf %lf"</span>,dum1,dum1,dum1,dum1,\
00289                                         &amp;D[0].QN0[di].i,&amp;D[0].QN0[di].j,&amp;D[0].QN0[di].k,&amp;D[0].QN0[di].d); 
00290                                 }
00291                         }
00292                 }
00293         nat=0;
00294 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; about to read coordinates.\n"</span>);}
00295         <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00296                 <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"DOCKED: ATOM"</span>)!=NULL){
00297 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; in atom scan.\n"</span>);}
00298                         nat++;
00299                         scntst=sscanf(line,<span class="stringliteral">"%s %s %d %s %s %d %lf %lf %lf"</span>,\
00300                                 dum1,dum2,&amp;anum,at,res,&amp;rnum,&amp;x,&amp;y,&amp;z);
00301                         <span class="comment">//if(rnum&gt;3020){rnum%=3020;}//Added to handle LSTC_1918 (Temporary)</span>
00302                         rnum-=fRes;
00303                         <span class="keywordflow">if</span>(scntst!=9){
00304                                 sprintf(whinetext,<span class="stringliteral">"end of line while reading DOCKED: ATOM (run %d)"</span>,(di+1));
00305                                 <a class="code" href="../../d9/dd3/read__eek_8c.html#a0">read_eek</a>(whinetext,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);}
00306                         <span class="keywordflow">if</span>(x&lt;xl){xl=x;}
00307                         <span class="keywordflow">if</span>(x&gt;xh){xh=x;}
00308                         <span class="keywordflow">if</span>(y&lt;yl){yl=y;}
00309                         <span class="keywordflow">if</span>(y&gt;yh){yh=y;}
00310                         <span class="keywordflow">if</span>(z&lt;zl){zl=z;}
00311                         <span class="keywordflow">if</span>(z&gt;zh){zh=z;}
00312                         ri=rnum-1;
00313                         <span class="keywordflow">if</span>(strcmp(D[0].M.r[ri].N,res)!=0){
00314                                 sprintf(whinetext,<span class="stringliteral">"residue name mismatch reading DOCKED: ATOM (run %d)"</span>,(di+1));
00315                                 <a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(whinetext); }
00316                         ai=AI[anum-1]; <span class="comment">// atom index</span>
00317 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: anum=%d ; ri=%d ; ai=%d ; di=%d.\n"</span>,anum,ri,ai,di);}
00318                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=x;
00319                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=y;
00320                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=z;
00321                         ti=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo4">t</a>; <span class="comment">// for convenience</span>
00322                         <span class="comment">// add to the COM determinations</span>
00323                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// molecule COM</span>
00324                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00325                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00326                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// residue COM</span>
00327                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00328                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00329                         }
00330                 <span class="keywordflow">if</span>(strstr(line,<span class="stringliteral">"DOCKED: ENDMDL"</span>)!=NULL){ 
00331                         <span class="comment">// finish COM calculation for molecule</span>
00332 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; in COM calc.\n"</span>);}
00333                         <span class="keywordflow">if</span>(nat!=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>){
00334                                 sprintf(whinetext,<span class="stringliteral">"didn't find enough atoms in run %d"</span>,(di+1));
00335                                 <a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(whinetext);}
00336                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00337                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00338                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00339 <span class="comment">//printf("center of mass (MW=%20.12e) is at: %20.12e %20.12e %20.12e \n",D[0].M.COM.i,D[0].M.COM.j,D[0].M.COM.k);</span>
00340                         <span class="comment">// also for the residues -- plus record atom number correlation</span>
00341                         <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){ 
00342                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00343                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00344                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00345                                 }
00346                         <span class="keywordflow">break</span>; <span class="comment">// leave this while read loop</span>
00347                         }
00348                 } <span class="comment">// close while read DOCKED info</span>
00349                 } <span class="comment">// close if FINAL LAMARCKIAN etc.</span>
00350         } <span class="comment">// close overall read through file while-fgets line</span>
00351 
00352 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo20">boxl</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=xl;
00353 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo20">boxl</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=yl;
00354 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo20">boxl</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=zl;
00355 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo21">boxh</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=xh;
00356 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo21">boxh</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=yh;
00357 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo21">boxh</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=zh;
00358 
00359 <span class="keywordflow">if</span>(localdebug==2){
00360         <a class="code" href="../../df/d0b/dXprint__X_8c.html#a8">dXprint_molecule</a>(&amp;D[0].M,5);
00361         <a class="code" href="../../df/d0b/dXprint__X_8c.html#a0">dXprint_coord_3D</a>(&amp;D[0].M.boxl);
00362         <a class="code" href="../../df/d0b/dXprint__X_8c.html#a0">dXprint_coord_3D</a>(&amp;D[0].M.boxh);
00363         }
00364 <span class="keywordflow">if</span>(localdebug&gt;2){<a class="code" href="../../df/d0b/dXprint__X_8c.html#a8">dXprint_molecule</a>(&amp;D[0].M,150);}
00365 
00366 <span class="keywordflow">if</span>(localdebug&gt;1){
00367 printf(<span class="stringliteral">"Molecule COM (main) is %20.15e %20.15e %20.15e\n"</span>,D[0].M.COM.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00368 printf(<span class="stringliteral">"\tThere are %d alternate COM's:\n"</span>,D[0].M.nrc);
00369 <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo18">nrc</a>;b++){
00370 printf(<span class="stringliteral">"\t\tCOM (alt %d) is %20.15e %20.15e %20.15e\n"</span>,b,D[0].M.rc[b].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00371 }
00372 printf(<span class="stringliteral">"\tThere are %d Residues:\n"</span>,D[0].M.nr); 
00373 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){
00374 printf(<span class="stringliteral">"\t\tmain COM (RES %d) is %20.15e %20.15e %20.15e\n"</span>,a,D[0].M.r[a].COM.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00375 }
00376 printf(<span class="stringliteral">"\t ...each with %d alternate COM's:\n"</span>,D[0].M.nrc); 
00377 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){
00378 <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo16">nrc</a>;b++){
00379 printf(<span class="stringliteral">"\t\tres %d alt %d : %20.15e %20.15e %20.15e\n"</span>,a,b,D[0].M.r[a].rc[b].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>); 
00380 }
00381 }
00382 }
00383 
00384 <span class="keywordflow">return</span> D;
00385 }
</pre></div>
<p>
    </td>
  </tr>
</table>

<p>
Here is the call graph for this function:<p><center><img src="../../db/d40/declarations_8h_a0_cgraph.png" border="0" usemap="#db/d40/declarations_8h_a0_cgraph_map" alt=""></center>
<map name="db/d40/declarations_8h_a0_cgraph_map">
<area href="../../da/d70/dprint__X_8c.html#a8" shape="rect" coords="160,132,275,159" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a0" shape="rect" coords="673,259,801,285" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a8" shape="rect" coords="156,259,279,285" alt="">
<area href="../../d9/d66/mywhine_8c.html#a0" shape="rect" coords="181,309,253,336" alt="">
<area href="../../d9/dd3/read__eek_8c.html#a0" shape="rect" coords="179,360,256,387" alt="">
<area href="../../da/d70/dprint__X_8c.html#a7" shape="rect" coords="333,107,437,133" alt="">
<area href="../../da/d70/dprint__X_8c.html#a5" shape="rect" coords="505,56,596,83" alt="">
<area href="../../da/d70/dprint__X_8c.html#a0" shape="rect" coords="677,107,797,133" alt="">
<area href="../../da/d70/dprint__X_8c.html#a6" shape="rect" coords="496,5,605,32" alt="">
<area href="../../da/d70/dprint__X_8c.html#a2" shape="rect" coords="504,157,597,184" alt="">
<area href="../../da/d70/dprint__X_8c.html#a4" shape="rect" coords="692,5,783,32" alt="">
<area href="../../da/d70/dprint__X_8c.html#a1" shape="rect" coords="663,56,812,83" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a7" shape="rect" coords="328,309,443,336" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a5" shape="rect" coords="501,309,600,336" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a6" shape="rect" coords="492,360,609,387" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a2" shape="rect" coords="499,411,603,437" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a4" shape="rect" coords="688,360,787,387" alt="">
<area href="../../df/d0b/dXprint__X_8c.html#a1" shape="rect" coords="659,309,816,336" alt="">
</map>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jul 21 17:08:04 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
