<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>GLYLIB: src/get_moiety_selection_assembly.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_4c50504df4ef4681d4a5a0710190c908.html">src</a>
  </div>
</div>
<div class="contents">
<h1>get_moiety_selection_assembly.c</h1><a href="../../de/d06/get__moiety__selection__assembly_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00045"></a>00045 <span class="preprocessor">#include "<a class="code" href="../../dd/dea/mylib_8h.html" title="generic header file that loads utilities often needed by programmers">mylib.h</a>"</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include "<a class="code" href="../../d3/de6/molecules_8h.html">molecules.h</a>"</span>
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="../../de/d06/get__moiety__selection__assembly_8c.html#6e90060b036943f73db656da5fd9ae72">00048</a> <a class="code" href="../../db/dac/structassembly.html">assembly</a> <a class="code" href="../../de/d06/get__moiety__selection__assembly_8c.html#6e90060b036943f73db656da5fd9ae72">get_moiety_selection_assembly</a>(<a class="code" href="../../de/d54/structensemble.html">ensemble</a> *E, <span class="keywordtype">int</span> nMS, <a class="code" href="../../d0/d18/structmoiety__selection.html">moiety_selection</a> *MS){
<a name="l00049"></a>00049 <span class="keywordtype">int</span>     am=0,ar=0,aa=0,ai=0,ams=0, 
<a name="l00050"></a>00050         aflag=0, 
<a name="l00051"></a>00051         numM=0, 
<a name="l00052"></a>00052         numR=0, 
<a name="l00053"></a>00053         numA=0; 
<a name="l00054"></a>00054 <a class="code" href="../../db/dac/structassembly.html">assembly</a> A; 
<a name="l00055"></a>00055 <a class="code" href="../../d6/d9d/structensemble__tree__index.html">ensemble_tree_index</a> IA; 
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">// Set up the tree of indices (IA) analogous to the m,r,a structure in E</span>
<a name="l00058"></a>00058 <span class="comment">//      initialize them all to be 0</span>
<a name="l00059"></a>00059 IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>=E[0].<a class="code" href="../../de/d54/structensemble.html#dfd8aaa3b537abec6eb0bb84395f9e00">nm</a>;
<a name="l00060"></a>00060 IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>=(<span class="keywordtype">int</span>*)calloc(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00061"></a>00061 IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>=(<a class="code" href="../../db/d68/structmolecule__tree__index.html">molecule_tree_index</a>*)calloc(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>,<span class="keyword">sizeof</span>(<a class="code" href="../../db/d68/structmolecule__tree__index.html">molecule_tree_index</a>));
<a name="l00062"></a>00062 <span class="keywordflow">for</span>(am=0;am&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>;am++){ <span class="comment">// for each molecule</span>
<a name="l00063"></a>00063         IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>=E[0].<a class="code" href="../../de/d54/structensemble.html#d3e890220a510a22f1f8ef4c1a391455">m</a>[am].<a class="code" href="../../dc/d7f/structmolecule.html#b45722e5d34f738a8af51b774c31631b">nr</a>;
<a name="l00064"></a>00064         IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>=(<span class="keywordtype">int</span>*)calloc(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00065"></a>00065         IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>=(<a class="code" href="../../d5/d64/structresidue__tree__index.html">residue_tree_index</a>*)calloc(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>,<span class="keyword">sizeof</span>(<a class="code" href="../../d5/d64/structresidue__tree__index.html">residue_tree_index</a>));
<a name="l00066"></a>00066         <span class="keywordflow">for</span>(ar=0;ar&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>;ar++){ <span class="comment">// for each residue </span>
<a name="l00067"></a>00067                 IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#de75c6dfb2e410f6794501699be7e5ba">na</a>=E[0].<a class="code" href="../../de/d54/structensemble.html#d3e890220a510a22f1f8ef4c1a391455">m</a>[am].<a class="code" href="../../dc/d7f/structmolecule.html#cf4979ff6bc7bf2ce6bb61710780257b">r</a>[ar].<a class="code" href="../../d0/d7e/structresidue.html#82f3cbc693fcd03518cb573775a18519">na</a>;
<a name="l00068"></a>00068                 IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>=(<span class="keywordtype">int</span>*)calloc(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#de75c6dfb2e410f6794501699be7e5ba">na</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00069"></a>00069                 }
<a name="l00070"></a>00070         }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 
<a name="l00078"></a>00078 <span class="keywordflow">for</span>(ams=0;ams&lt;nMS;ams++){
<a name="l00079"></a>00079 
<a name="l00081"></a>00081 <span class="keywordflow">if</span>(MS[ams].posneg==1){ 
<a name="l00082"></a>00082         <span class="comment">// Molecules</span>
<a name="l00083"></a>00083         <span class="comment">// For each molecule index specified</span>
<a name="l00084"></a>00084         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#dd99590fe49b69d66fc28dae4c927577">nmi</a>;ai++){ IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#525765145d8aa27314ae9531230cb9fc">mi</a>[ai]]=1; }
<a name="l00085"></a>00085         <span class="comment">// Check each molecule for names and numbers</span>
<a name="l00086"></a>00086         <span class="keywordflow">for</span>(am=0;am&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>;am++){ 
<a name="l00087"></a>00087                 <span class="comment">// For each name specified</span>
<a name="l00088"></a>00088                 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#435069295c17da60e5cf72b953dd5cce">nmN</a>;ai++){ <span class="keywordflow">if</span>((E[0].m[am].N!=NULL)&amp;&amp;(strcmp(E[0].m[am].N,MS[ams].mN[ai])==0)){IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]=1;} }
<a name="l00089"></a>00089                 <span class="comment">// For each number specified</span>
<a name="l00090"></a>00090                 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#29d05ef451957ec55a6a67566fac4f99">nmn</a>;ai++){ <span class="keywordflow">if</span>(E[0].m[am].n==MS[ams].mn[ai]){IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]=1;} } 
<a name="l00091"></a>00091         
<a name="l00092"></a>00092                 <span class="comment">// Residues</span>
<a name="l00093"></a>00093                 <span class="comment">// For each index specified</span>
<a name="l00094"></a>00094                 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#017218e2b1ffc05476090f89b2805fbb">nri</a>;ai++){ IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#a02841f40c4a60dc8cb03d47426ec51f" title="# of residue names, numbers &amp;amp; indicies, nrn numbers and nri indices">ri</a>[ai]]=1; }
<a name="l00095"></a>00095                 <span class="comment">// Now, check each residue for names and numbers </span>
<a name="l00096"></a>00096                 <span class="keywordflow">for</span>(ar=0;ar&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>;ar++){ 
<a name="l00097"></a>00097                         <span class="comment">// For each name specified</span>
<a name="l00098"></a>00098                         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#39fd8abf41b52321f78ac7c94dbf33e6">nrN</a>;ai++){ <span class="keywordflow">if</span>((E[0].m[am].r[ar].N!=NULL)&amp;&amp;(strcmp(E[0].m[am].r[ar].N,MS[ams].rN[ai])==0)){IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]=1;} }
<a name="l00099"></a>00099                         <span class="comment">// For each number specified</span>
<a name="l00100"></a>00100                         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#f3e2ac5e987e59bf6f4723454ba7d8ae">nrn</a>;ai++){ <span class="keywordflow">if</span>(E[0].m[am].r[ar].n==MS[ams].rn[ai]){IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]=1;} }     
<a name="l00101"></a>00101 
<a name="l00102"></a>00102                         <span class="comment">// Atoms</span>
<a name="l00103"></a>00103                         <span class="comment">// For each index specified</span>
<a name="l00104"></a>00104                         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#295a757e0448f66853be485cf5a50695">nai</a>;ai++){ IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#d1baf37ce129b978d8b02611e5de58c9" title="# of atom names, numbers &amp;amp; indicies, nan numbers and nai indices">ai</a>[ai]]=1; }
<a name="l00105"></a>00105                         <span class="comment">// Now, check each residue for names and numbers </span>
<a name="l00106"></a>00106                         <span class="keywordflow">for</span>(aa=0;aa&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#de75c6dfb2e410f6794501699be7e5ba">na</a>;aa++){ 
<a name="l00107"></a>00107 <span class="comment">// For each atom name specified</span>
<a name="l00108"></a>00108 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#30e9c0bc828b2235b6a6c72ad9e51f5f">naN</a>;ai++){ <span class="keywordflow">if</span>((E[0].m[am].r[ar].a[aa].N!=NULL)&amp;&amp;(strcmp(E[0].m[am].r[ar].a[aa].N,MS[ams].aN[ai])==0)){IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]=1;} }
<a name="l00109"></a>00109 <span class="comment">// For each atom number specified</span>
<a name="l00110"></a>00110 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#66896910787ff3e34af1571bab7dacaf">nan</a>;ai++){ <span class="keywordflow">if</span>(E[0].m[am].r[ar].a[aa].n==MS[ams].an[ai]){IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]=1;} } 
<a name="l00111"></a>00111                                 } <span class="comment">// close aa loop</span>
<a name="l00112"></a>00112                         } <span class="comment">// close ar loop</span>
<a name="l00113"></a>00113                 } <span class="comment">// close am loop</span>
<a name="l00114"></a>00114         } <span class="comment">// close if positive MS condition</span>
<a name="l00115"></a>00115 
<a name="l00117"></a>00117 <span class="keywordflow">if</span>(MS[ams].posneg==1){ 
<a name="l00118"></a>00118         <span class="comment">// Molecules</span>
<a name="l00119"></a>00119         <span class="comment">// Check each molecule for names and numbers</span>
<a name="l00120"></a>00120         <span class="keywordflow">for</span>(am=0;am&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>;am++){ 
<a name="l00121"></a>00121                 <span class="comment">// For each molecule index specified</span>
<a name="l00122"></a>00122                 aflag=1;
<a name="l00123"></a>00123                 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#dd99590fe49b69d66fc28dae4c927577">nmi</a>;ai++){ <span class="keywordflow">if</span>(am==MS[ams].mi[ai]) aflag=0; }
<a name="l00124"></a>00124                 <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]=1; }
<a name="l00125"></a>00125                 <span class="comment">// For each name specified</span>
<a name="l00126"></a>00126                 aflag=1;
<a name="l00127"></a>00127                 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#435069295c17da60e5cf72b953dd5cce">nmN</a>;ai++){ <span class="keywordflow">if</span>((E[0].m[am].N!=NULL)&amp;&amp;(strcmp(E[0].m[am].N,MS[ams].mN[ai])==0)){aflag=0;} }
<a name="l00128"></a>00128                 <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]=1; }
<a name="l00129"></a>00129                 <span class="comment">// For each number specified</span>
<a name="l00130"></a>00130                 aflag=1;
<a name="l00131"></a>00131                 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#29d05ef451957ec55a6a67566fac4f99">nmn</a>;ai++){ <span class="keywordflow">if</span>(E[0].m[am].n==MS[ams].mn[ai]){aflag=0;} }     
<a name="l00132"></a>00132                 <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]=1; }
<a name="l00133"></a>00133         
<a name="l00134"></a>00134                 <span class="comment">// Residues</span>
<a name="l00135"></a>00135                 <span class="comment">// Now, check each residue for names and numbers </span>
<a name="l00136"></a>00136                 <span class="keywordflow">for</span>(ar=0;ar&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>;ar++){ 
<a name="l00137"></a>00137                         <span class="comment">// For each index specified</span>
<a name="l00138"></a>00138                         aflag=1;
<a name="l00139"></a>00139                         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#017218e2b1ffc05476090f89b2805fbb">nri</a>;ai++){ <span class="keywordflow">if</span>(ar==MS[ams].ri[ai]) aflag=0; }
<a name="l00140"></a>00140                         <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]=1; }
<a name="l00141"></a>00141                         <span class="comment">// For each name specified</span>
<a name="l00142"></a>00142                         aflag=1;
<a name="l00143"></a>00143                         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#39fd8abf41b52321f78ac7c94dbf33e6">nrN</a>;ai++){ <span class="keywordflow">if</span>((E[0].m[am].r[ar].N!=NULL)&amp;&amp;(strcmp(E[0].m[am].r[ar].N,MS[ams].rN[ai])==0)){aflag=0;} }
<a name="l00144"></a>00144                         <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]=1; }
<a name="l00145"></a>00145                         <span class="comment">// For each number specified</span>
<a name="l00146"></a>00146                         aflag=1;
<a name="l00147"></a>00147                         <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#f3e2ac5e987e59bf6f4723454ba7d8ae">nrn</a>;ai++){ <span class="keywordflow">if</span>(E[0].m[am].r[ar].n==MS[ams].rn[ai]){aflag=0;} }       
<a name="l00148"></a>00148                         <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]=1; }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150                         <span class="comment">// Atoms</span>
<a name="l00151"></a>00151                         <span class="comment">// Now, check each residue for names and numbers </span>
<a name="l00152"></a>00152                         <span class="keywordflow">for</span>(aa=0;aa&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#de75c6dfb2e410f6794501699be7e5ba">na</a>;aa++){ 
<a name="l00153"></a>00153 <span class="comment">// For each index specified</span>
<a name="l00154"></a>00154 aflag=1;
<a name="l00155"></a>00155 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#295a757e0448f66853be485cf5a50695">nai</a>;ai++){ <span class="keywordflow">if</span>(aa==MS[ams].ai[ai]) aflag=0; }
<a name="l00156"></a>00156 <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]=1; } 
<a name="l00157"></a>00157 <span class="comment">// For each atom name specified</span>
<a name="l00158"></a>00158 aflag=1;
<a name="l00159"></a>00159 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#30e9c0bc828b2235b6a6c72ad9e51f5f">naN</a>;ai++){ <span class="keywordflow">if</span>((E[0].m[am].r[ar].a[aa].N!=NULL)&amp;&amp;(strcmp(E[0].m[am].r[ar].a[aa].N,MS[ams].aN[ai])==0)){aflag=0;} }
<a name="l00160"></a>00160 <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]=1; } 
<a name="l00161"></a>00161 <span class="comment">// For each atom number specified</span>
<a name="l00162"></a>00162 aflag=1;
<a name="l00163"></a>00163 <span class="keywordflow">for</span>(ai=0;ai&lt;MS[ams].<a class="code" href="../../d0/d18/structmoiety__selection.html#66896910787ff3e34af1571bab7dacaf">nan</a>;ai++){ <span class="keywordflow">if</span>(E[0].m[am].r[ar].a[aa].n==MS[ams].an[ai]){aflag=0;} } 
<a name="l00164"></a>00164 <span class="keywordflow">if</span>(aflag==1) { IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]=1; } 
<a name="l00165"></a>00165                                 } <span class="comment">// close aa loop</span>
<a name="l00166"></a>00166                         } <span class="comment">// close ar loop</span>
<a name="l00167"></a>00167                 } <span class="comment">// close am loop</span>
<a name="l00168"></a>00168         } <span class="comment">// close if negative MS condition</span>
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         } <span class="comment">// close ams loop</span>
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 <span class="comment">// after all the indices are set for selection, count, in IA, the number of</span>
<a name="l00173"></a>00173 <span class="comment">//      m, r and a pointers the assembly will need and allocate them.</span>
<a name="l00174"></a>00174 numM=numR=numA=0;
<a name="l00175"></a>00175 <span class="keywordflow">for</span>(am=0;am&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>;am++){ <span class="keywordflow">if</span>(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]&gt;0) numM++;
<a name="l00176"></a>00176         <span class="keywordflow">for</span>(ar=0;ar&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>;ar++){ <span class="keywordflow">if</span>(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]&gt;0) numR++;
<a name="l00177"></a>00177                 <span class="keywordflow">for</span>(aa=0;aa&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#de75c6dfb2e410f6794501699be7e5ba">na</a>;am++){ <span class="keywordflow">if</span>(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]==1) numA++;
<a name="l00178"></a>00178                         }
<a name="l00179"></a>00179                 }
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181 A.<a class="code" href="../../db/dac/structassembly.html#70e636603496fcaff42dd428d3fd6b7f">nm</a>=numM;
<a name="l00182"></a>00182 A.<a class="code" href="../../db/dac/structassembly.html#1b0e84767d2d7f8b80daa56cc253d813">m</a>=(<a class="code" href="../../dc/d7f/structmolecule.html">molecule</a>**)calloc(A.<a class="code" href="../../db/dac/structassembly.html#70e636603496fcaff42dd428d3fd6b7f">nm</a>,<span class="keyword">sizeof</span>(<a class="code" href="../../dc/d7f/structmolecule.html">molecule</a>*));
<a name="l00183"></a>00183 A.<a class="code" href="../../db/dac/structassembly.html#93940c923252a444f097ae2fd16971d1">nr</a>=numR;
<a name="l00184"></a>00184 A.<a class="code" href="../../db/dac/structassembly.html#6db297fe582508bd1216ae48271b54c4">r</a>=(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>**)calloc(A.<a class="code" href="../../db/dac/structassembly.html#93940c923252a444f097ae2fd16971d1">nr</a>,<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>*)); 
<a name="l00185"></a>00185 A.<a class="code" href="../../db/dac/structassembly.html#b9c1aaaad19674c787642b6bdb510343">na</a>=numA;
<a name="l00186"></a>00186 A.<a class="code" href="../../db/dac/structassembly.html#1dec690a12cdf1414200aeeed5e81ac9">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>**)calloc(A.<a class="code" href="../../db/dac/structassembly.html#b9c1aaaad19674c787642b6bdb510343">na</a>,<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>*)); 
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">// Walk through IA and set an appropriate pointer whenever a "1" is encountered</span>
<a name="l00189"></a>00189 numM=numR=numA=0;
<a name="l00190"></a>00190 <span class="keywordflow">for</span>(am=0;am&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#e24f60848a1a8581c310171759328b25">nm</a>;am++){ 
<a name="l00191"></a>00191         <span class="keywordflow">if</span>(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#b0b4ece887b11e62a960064084ae9906">mi</a>[am]&gt;0){
<a name="l00192"></a>00192                 A.<a class="code" href="../../db/dac/structassembly.html#1b0e84767d2d7f8b80daa56cc253d813">m</a>[numM]=&amp;E[0].<a class="code" href="../../de/d54/structensemble.html#d3e890220a510a22f1f8ef4c1a391455">m</a>[am];
<a name="l00193"></a>00193                 numM++;
<a name="l00194"></a>00194                 <span class="keywordflow">if</span>(numM&gt;A.<a class="code" href="../../db/dac/structassembly.html#70e636603496fcaff42dd428d3fd6b7f">nm</a>){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"get_moiety_selection_assembly: memory allocation issue in A.nm/numM"</span>);}
<a name="l00195"></a>00195                 }
<a name="l00196"></a>00196         <span class="keywordflow">for</span>(ar=0;ar&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#af9bccf869b2199746a8c27fd5ca8d8e">nr</a>;ar++){ 
<a name="l00197"></a>00197                 <span class="keywordflow">if</span>(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#ca2208519eac8d3b3be4dbabd741eba3">ri</a>[ar]&gt;0){
<a name="l00198"></a>00198                         A.<a class="code" href="../../db/dac/structassembly.html#6db297fe582508bd1216ae48271b54c4">r</a>[numR]=&amp;E[0].<a class="code" href="../../de/d54/structensemble.html#d3e890220a510a22f1f8ef4c1a391455">m</a>[am].<a class="code" href="../../dc/d7f/structmolecule.html#cf4979ff6bc7bf2ce6bb61710780257b">r</a>[ar];
<a name="l00199"></a>00199                         numR++;
<a name="l00200"></a>00200                         <span class="keywordflow">if</span>(numR&gt;A.<a class="code" href="../../db/dac/structassembly.html#93940c923252a444f097ae2fd16971d1">nr</a>){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"get_moiety_selection_assembly: memory allocation issue in A.nr/numR"</span>);}
<a name="l00201"></a>00201                         }
<a name="l00202"></a>00202                 <span class="keywordflow">for</span>(aa=0;aa&lt;IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#de75c6dfb2e410f6794501699be7e5ba">na</a>;am++){ 
<a name="l00203"></a>00203                         <span class="keywordflow">if</span>(IA.<a class="code" href="../../d6/d9d/structensemble__tree__index.html#f142a74f1633a13f6626a92355f01e0b">m</a>[am].<a class="code" href="../../db/d68/structmolecule__tree__index.html#5004f59f7a815027f32020fca770ca6e">r</a>[ar].<a class="code" href="../../d5/d64/structresidue__tree__index.html#40209b547467368e068c4b9ba2cc5ffb">ai</a>[aa]==1){
<a name="l00204"></a>00204                                 A.<a class="code" href="../../db/dac/structassembly.html#1dec690a12cdf1414200aeeed5e81ac9">a</a>[numA]=&amp;E[0].<a class="code" href="../../de/d54/structensemble.html#d3e890220a510a22f1f8ef4c1a391455">m</a>[am].<a class="code" href="../../dc/d7f/structmolecule.html#cf4979ff6bc7bf2ce6bb61710780257b">r</a>[ar].<a class="code" href="../../d0/d7e/structresidue.html#35582b318123377171e24d2dc47d5e2a">a</a>[aa];
<a name="l00205"></a>00205                                 numA++;
<a name="l00206"></a>00206                                 <span class="keywordflow">if</span>(numA&gt;A.<a class="code" href="../../db/dac/structassembly.html#b9c1aaaad19674c787642b6bdb510343">na</a>){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"get_moiety_selection_assembly: memory allocation issue in A.na/numA"</span>);}
<a name="l00207"></a>00207                                 }
<a name="l00208"></a>00208                         }
<a name="l00209"></a>00209                 }
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="keywordflow">return</span> A;
<a name="l00213"></a>00213 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Oct 7 18:13:38 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
