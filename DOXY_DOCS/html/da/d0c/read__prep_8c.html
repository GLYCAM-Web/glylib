<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>GLYLIB: read_prep.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_fba7d38c13d62fc3c519a83038ccbec0.html">src</a>
  </div>
</div>
<div class="contents">
<h1>read_prep.c File Reference</h1><code>#include &lt;<a class="el" href="../../d8/d8f/mylib_8h-source.html">mylib.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../da/dff/molecules_8h-source.html">molecules.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d5/d31/general_8h-source.html">general.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../dc/db8/read__prep_8h-source.html">AMBER/read_prep.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d9/dc7/declarations_8h-source.html">declarations.h</a>&gt;</code><br>

<p>
<div class="dynheader">
Include dependency graph for read_prep.c:</div>
<div class="dynsection">
<p><center><img src="../../de/ddb/read__prep_8c__incl.gif" border="0" usemap="#read_prep.c_map" alt=""></center>
<map name="read_prep.c_map">
<area shape="rect" href="../../dd/dea/mylib_8h.html" title="generic header file that loads utilities often needed by programmers" alt="" coords="383,80,444,107"><area shape="rect" href="../../d9/d14/general_8h.html" title="Convenience structures used by various functions within the library." alt="" coords="675,155,744,181"><area shape="rect" href="../../d3/de6/molecules_8h.html" title="molecules.h" alt="" coords="763,80,848,107"><area shape="rect" href="../../d3/d65/read__prep_8h.html" title="AMBER/read_prep.h" alt="" coords="872,80,1008,107"><area shape="rect" href="../../db/d40/declarations_8h.html" title="declarations.h" alt="" coords="1032,80,1128,107"><area shape="rect" href="../../d4/ddb/geometries_8h.html" title="geometries.h" alt="" coords="768,155,856,181"><area shape="rect" href="../../d1/d10/parameter__sets_8h.html" title="parameter_sets.h" alt="" coords="880,155,989,181"></map>
</div>

<p>
<a href="../../de/d85/read__prep_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d0c/read__prep_8c.html#2af97deb8c94ca0bc4e575c53ff2cd90">read_prep</a> (<a class="el" href="../../dc/d7f/structmolecule.html">molecule</a> *M, <a class="el" href="../../dc/d59/structfileset.html">fileset</a> F, <a class="el" href="../../d5/de2/structtypes.html">types</a> *TYP)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d0/d7e/structresidue.html">residue</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d0c/read__prep_8c.html#6be83cebe121fdaa2e3603f8389c39fc">read_prepres</a> (<a class="el" href="../../dc/d59/structfileset.html">fileset</a> F, <a class="el" href="../../d5/de2/structtypes.html">types</a> *TYP)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../da/d81/structatom.html">atom</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d0c/read__prep_8c.html#3188c5030e980c9b7883c885add832f1">read_prepatom</a> (const char *<a class="el" href="../../d7/d40/load__pdb_8h.html#c0943872323c1ec7d8f0db57e0bdbbb6">line</a>, <a class="el" href="../../d5/de2/structtypes.html">types</a> *TYP)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="2af97deb8c94ca0bc4e575c53ff2cd90"></a><!-- doxytag: member="read_prep.c::read_prep" ref="2af97deb8c94ca0bc4e575c53ff2cd90" args="(molecule *M, fileset F, types *TYP)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_prep           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d7f/structmolecule.html">molecule</a> *&nbsp;</td>
          <td class="paramname"> <em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d59/structfileset.html">fileset</a>&nbsp;</td>
          <td class="paramname"> <em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/de2/structtypes.html">types</a> *&nbsp;</td>
          <td class="paramname"> <em>TYP</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="../../de/d85/read__prep_8c-source.html#l00041">41</a> of file <a class="el" href="../../de/d85/read__prep_8c-source.html">read_prep.c</a>.</p>

<p>References <a class="el" href="../../d5/d31/general_8h-source.html#l00034">fileset::F</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00018">ambermprepinfo::FN</a>, <a class="el" href="../../d7/d04/load__pdb_8h-source.html#l00028">line</a>, <a class="el" href="../../d9/dc2/myfopen_8c-source.html#l00025">myfreopen()</a>, <a class="el" href="../../d7/d30/mywhine_8c-source.html#l00007">mywhine()</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00033">fileset::N</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00019">ambermprepinfo::NAMDBF</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00182">molecule::nr</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00200">molecule::nVP</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00183">molecule::r</a>, <a class="el" href="../../de/d85/read__prep_8c-source.html#l00097">read_prepres()</a>, and <a class="el" href="../../da/dff/molecules_8h-source.html#l00201">molecule::VP</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00041"></a>00041                                                   {
<a name="l00042"></a>00042 <span class="keywordtype">int</span> rpa=0,stopflag=1,rpuse=0,rpsz=0,rpbins=0;
<a name="l00043"></a>00043 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#c0943872323c1ec7d8f0db57e0bdbbb6">line</a>[501];
<a name="l00044"></a>00044 <a class="code" href="../../d3/dc4/structambermprepinfo.html">ambermprepinfo</a> *amp;
<a name="l00045"></a>00045 fpos_t f_linestart;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 M[0].<a class="code" href="../../dc/d7f/structmolecule.html#92c6ba1667d5fbfe4c7395c9e12eef94">nVP</a>=1;
<a name="l00048"></a>00048 amp=(<a class="code" href="../../d3/dc4/structambermprepinfo.html">ambermprepinfo</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/structambermprepinfo.html">ambermprepinfo</a>));
<a name="l00049"></a>00049 F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>=<a class="code" href="../../df/da0/group__FILE__UTILS.html#gb1eb9a7cbe4d705465f2270550ace4c4" title="Like myfopen, but the freopen version.">myfreopen</a>(F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>,<span class="stringliteral">"r"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// don't depend on calling function to have opened</span>
<a name="l00050"></a>00050 amp[0].<a class="code" href="../../d3/dc4/structambermprepinfo.html#06d3dca8ac637bf64a528da25f2975ca">FN</a>=strdup(F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);
<a name="l00051"></a>00051 fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>);
<a name="l00052"></a>00052 sscanf(line,<span class="stringliteral">"%d %d %d"</span>,&amp;amp[0].IDBGEN,&amp;amp[0].IREST,&amp;amp[0].ITYPF);
<a name="l00053"></a>00053 fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>);
<a name="l00054"></a>00054 amp[0].<a class="code" href="../../d3/dc4/structambermprepinfo.html#db813bd0a319b34d999c5415f4922d95">NAMDBF</a>=strdup(line);
<a name="l00055"></a>00055 M[0].<a class="code" href="../../dc/d7f/structmolecule.html#fba791390d31b3fb143defda7c0cb879">VP</a>=amp;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 rpuse=malloc_usable_size(M[0].r);
<a name="l00058"></a>00058 rpsz=<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>);
<a name="l00059"></a>00059 rpbins=rpuse/rpsz;
<a name="l00060"></a>00060 <span class="keywordflow">if</span>(rpbins&lt;1){<a class="code" href="../../dd/dea/mylib_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"read_prep: no space in residue -- is molecule not initialized?"</span>);}
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">//printf("about to read through the file. Current line is\n\t&gt;&gt;%s&lt;&lt;\n",line);</span>
<a name="l00063"></a>00063 fgetpos(F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>,&amp;f_linestart);<span class="comment">// get current position</span>
<a name="l00064"></a>00064 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>)!=NULL){<span class="comment">// while not end of file</span>
<a name="l00065"></a>00065 <span class="comment">//printf("\treading a line ...  line is\n&gt;&gt;%s&lt;&lt;\n",line);</span>
<a name="l00066"></a>00066         stopflag=1;
<a name="l00067"></a>00067         <span class="keywordflow">for</span>(rpa=0;rpa&lt;strlen(line);rpa++){<span class="comment">// if the first word is not "STOP" (and only that??)</span>
<a name="l00068"></a>00068                 <span class="keywordflow">if</span>((line[rpa]!=<span class="charliteral">'\t'</span>)&amp;&amp;(line[rpa]!=<span class="charliteral">' '</span>)){
<a name="l00069"></a>00069 <span class="comment">//printf("rpa is %d and line[rpa] is &gt;&gt;%c&lt;&lt; and strlen(line) is %d\n",rpa,line[rpa],strlen(line));</span>
<a name="l00070"></a>00070                         <span class="keywordflow">if</span>(rpa+4&gt;strlen(line)){<span class="keywordflow">break</span>;}
<a name="l00071"></a>00071                         <span class="keywordflow">else</span>{ 
<a name="l00072"></a>00072                                 <span class="keywordflow">if</span>((line[rpa]==<span class="charliteral">'S'</span>)&amp;&amp;(line[rpa+1]==<span class="charliteral">'T'</span>)&amp;&amp;(line[rpa+2]==<span class="charliteral">'O'</span>)&amp;&amp;(line[rpa+3]==<span class="charliteral">'P'</span>)){ 
<a name="l00073"></a>00073                                         stopflag=0;
<a name="l00074"></a>00074                                         }
<a name="l00075"></a>00075                                 <span class="keywordflow">break</span>;
<a name="l00076"></a>00076                                 }
<a name="l00077"></a>00077                         }
<a name="l00078"></a>00078                 }
<a name="l00079"></a>00079 <span class="comment">//printf("stopflag is %d\n",stopflag);</span>
<a name="l00080"></a>00080         <span class="keywordflow">if</span>(stopflag==0){<span class="keywordflow">break</span>;} <span class="comment">// break loop</span>
<a name="l00081"></a>00081 <span class="comment">//printf("about to allocate space for the residue...\n");</span>
<a name="l00082"></a>00082         M[0].<a class="code" href="../../dc/d7f/structmolecule.html#b45722e5d34f738a8af51b774c31631b">nr</a>++;<span class="comment">// allocate new memory for a residue</span>
<a name="l00083"></a>00083         M[0].<a class="code" href="../../dc/d7f/structmolecule.html#cf4979ff6bc7bf2ce6bb61710780257b">r</a>=(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>*)realloc(M[0].r,M[0].nr*<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>));
<a name="l00084"></a>00084         fsetpos(F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>,&amp;f_linestart); <span class="comment">// rewind to start of line</span>
<a name="l00085"></a>00085         M[0].<a class="code" href="../../dc/d7f/structmolecule.html#cf4979ff6bc7bf2ce6bb61710780257b">r</a>[M[0].<a class="code" href="../../dc/d7f/structmolecule.html#b45722e5d34f738a8af51b774c31631b">nr</a>-1]=<a class="code" href="../../d3/d65/read__prep_8h.html#6be83cebe121fdaa2e3603f8389c39fc">read_prepres</a>(F,TYP);<span class="comment">// call read_prepres to read in the residue information</span>
<a name="l00086"></a>00086         fgetpos(F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>,&amp;f_linestart);<span class="comment">// get current position </span>
<a name="l00087"></a>00087         } <span class="comment">// end while not end of file</span>
<a name="l00088"></a>00088 <span class="keywordflow">return</span>;
<a name="l00089"></a>00089 }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="../../da/d0c/read__prep_8c_2af97deb8c94ca0bc4e575c53ff2cd90_cgraph.gif" border="0" usemap="#da/d0c/read__prep_8c_2af97deb8c94ca0bc4e575c53ff2cd90_cgraph_map" alt=""></center>
<map name="da/d0c/read__prep_8c_2af97deb8c94ca0bc4e575c53ff2cd90_cgraph_map">
<area shape="rect" href="../../df/da0/group__FILE__UTILS.html#gb1eb9a7cbe4d705465f2270550ace4c4" title="Like myfopen, but the freopen version." alt="" coords="135,5,212,32"><area shape="rect" href="../../dd/dea/mylib_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1)." alt="" coords="417,107,487,133"><area shape="rect" href="../../d3/d65/read__prep_8h.html#6be83cebe121fdaa2e3603f8389c39fc" title="read_prepres" alt="" coords="128,132,219,159"><area shape="rect" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails." alt="" coords="283,107,352,133"><area shape="rect" href="../../d3/d65/read__prep_8h.html#3188c5030e980c9b7883c885add832f1" title="read_prepatom" alt="" coords="267,157,368,184"><area shape="rect" href="../../d3/de6/molecules_8h.html#dc0a15e5e592bed33584b4c9814aaf91" title="zero_coord" alt="" coords="277,208,357,235"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3188c5030e980c9b7883c885add832f1"></a><!-- doxytag: member="read_prep.c::read_prepatom" ref="3188c5030e980c9b7883c885add832f1" args="(const char *line, types *TYP)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d81/structatom.html">atom</a> read_prepatom           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/de2/structtypes.html">types</a> *&nbsp;</td>
          <td class="paramname"> <em>TYP</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="../../de/d85/read__prep_8c-source.html#l00235">235</a> of file <a class="el" href="../../de/d85/read__prep_8c-source.html">read_prep.c</a>.</p>

<p>References <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00037">amberaprepinfo::I</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00038">amberaprepinfo::IGRAPH</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00039">amberaprepinfo::ISYMBL</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00040">amberaprepinfo::ITREE</a>, <a class="el" href="../../d7/d30/mywhine_8c-source.html#l00007">mywhine()</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00103">atom::n</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00104">atom::N</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00112">types::na</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00130">atom::nVP</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00107">atom::t</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00105">atom::T</a>, and <a class="el" href="../../da/dff/molecules_8h-source.html#l00131">atom::VP</a>.</p>

<p>Referenced by <a class="el" href="../../de/d85/read__prep_8c-source.html#l00097">read_prepres()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00235"></a>00235                                                 {
<a name="l00236"></a>00236 <a class="code" href="../../df/d84/structamberaprepinfo.html">amberaprepinfo</a> *aap;
<a name="l00237"></a>00237 <a class="code" href="../../da/d81/structatom.html">atom</a> A;
<a name="l00238"></a>00238 <span class="keywordtype">char</span> N[21],T[21],C[21]; <span class="comment">// if any entry is longer than 21 chars, something is wrong...</span>
<a name="l00239"></a>00239 <span class="keywordtype">char</span> whinetext[201]; <span class="comment">// error message text</span>
<a name="l00240"></a>00240 <span class="keywordtype">int</span> raa=0;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="comment">// Most of this will go into an amberaprepinfo structure.</span>
<a name="l00243"></a>00243 <span class="comment">// Some bits also go into an atom structure</span>
<a name="l00244"></a>00244 <span class="comment">// Here is a typical prep-file atom line:</span>
<a name="l00245"></a>00245 <span class="comment">//      &gt;&gt; 4 C1   CG  M  3  2  1  1.400   113.9      60.0     0.4780&lt;&lt;</span>
<a name="l00246"></a>00246 <span class="comment">//         1  2   3   4  5  6  7    8      9          10       11</span>
<a name="l00247"></a>00247 <span class="comment">//      The atom structure bits:</span>
<a name="l00248"></a>00248 <span class="comment">//      1: A.n</span>
<a name="l00249"></a>00249 <span class="comment">//      2: A.N=strdup(2)</span>
<a name="l00250"></a>00250 <span class="comment">//      3: A.T=strdup(3)  --and-- A.t=number for type 3</span>
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 aap=(<a class="code" href="../../df/d84/structamberaprepinfo.html">amberaprepinfo</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../df/d84/structamberaprepinfo.html">amberaprepinfo</a>));
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#c0943872323c1ec7d8f0db57e0bdbbb6">line</a>,<span class="stringliteral">"%d %s %s %s %d %d %d %lf %lf %lf %lf"</span>,\
<a name="l00255"></a>00255         &amp;aap[0].I,N,T,C,&amp;aap[0].NA,&amp;aap[0].NB,&amp;aap[0].NC,&amp;aap[0].R,&amp;aap[0].THETA,&amp;aap[0].PHI,&amp;aap[0].CHG);
<a name="l00256"></a>00256 A.<a class="code" href="../../da/d81/structatom.html#ffa12be28aae3ed4401d7ac1d469a65a">N</a>=strdup(N);
<a name="l00257"></a>00257 aap[0].<a class="code" href="../../df/d84/structamberaprepinfo.html#2c9db9e2a1096294ecf44d5cc792316e">IGRAPH</a>=strdup(N);
<a name="l00258"></a>00258 A.<a class="code" href="../../da/d81/structatom.html#f14335c1ea4f916d84b72ebd1b514aca">T</a>=strdup(T);
<a name="l00259"></a>00259 aap[0].<a class="code" href="../../df/d84/structamberaprepinfo.html#48ea04260779ff4780a57525886f77f4">ISYMBL</a>=strdup(T);
<a name="l00260"></a>00260 aap[0].<a class="code" href="../../df/d84/structamberaprepinfo.html#d204068db90fdbe653c3848503343b5e">ITREE</a>=strdup(C);
<a name="l00261"></a>00261 A.<a class="code" href="../../da/d81/structatom.html#96e1df3770238c3d598d8bbf9d07957f">n</a>=aap[0].<a class="code" href="../../df/d84/structamberaprepinfo.html#8d0383c6681218e6e25d172406643d98">I</a>-3; 
<a name="l00262"></a>00262 <span class="comment">// set the atom's type according to the data in TYP</span>
<a name="l00263"></a>00263 A.<a class="code" href="../../da/d81/structatom.html#0007983fb28310826dfd6851d92b6d4a">t</a>=-1;
<a name="l00264"></a>00264 <span class="keywordflow">for</span>(raa=0;raa&lt;TYP[0].<a class="code" href="../../d5/de2/structtypes.html#2bb14dd5c8d2e17fc378cec167d8d252">na</a>;raa++){
<a name="l00265"></a>00265 <span class="comment">//printf("TYP[0].a[raa].N is &gt;&gt;%s&lt;&lt; ; A.T is &gt;&gt;%s&lt;&lt;\n",TYP[0].a[raa].N,A.T);</span>
<a name="l00266"></a>00266         <span class="keywordflow">if</span>(strcmp(TYP[0].a[raa].N,A.<a class="code" href="../../da/d81/structatom.html#f14335c1ea4f916d84b72ebd1b514aca">T</a>)==0){ 
<a name="l00267"></a>00267                 A.<a class="code" href="../../da/d81/structatom.html#0007983fb28310826dfd6851d92b6d4a">t</a>=raa; 
<a name="l00268"></a>00268                 <span class="keywordflow">break</span>;} }
<a name="l00269"></a>00269 <span class="keywordflow">if</span>(A.<a class="code" href="../../da/d81/structatom.html#0007983fb28310826dfd6851d92b6d4a">t</a>==-1){
<a name="l00270"></a>00270         sprintf(whinetext,<span class="stringliteral">"read_prepatom:\n\tMatch not found for atom type %s.  The prep file line follows:\n\n%s\n\n"</span>,A.<a class="code" href="../../da/d81/structatom.html#f14335c1ea4f916d84b72ebd1b514aca">T</a>,<a class="code" href="../../d7/d40/load__pdb_8h.html#c0943872323c1ec7d8f0db57e0bdbbb6">line</a>);
<a name="l00271"></a>00271         <a class="code" href="../../dd/dea/mylib_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(whinetext);
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273 <span class="comment">//printf("The entire line is:\n");</span>
<a name="l00274"></a>00274 <span class="comment">/*printf("%d %s %s %s %d %d %d %f %f %f %f\n",aap[0].I,aap[0].IGRAPH,aap[0].ISYMBL,\</span>
<a name="l00275"></a>00275 <span class="comment">        aap[0].ITREE,aap[0].NA,aap[0].NB,aap[0].NC,aap[0].R,aap[0].THETA,aap[0].PHI,aap[0].CHG);*/</span>
<a name="l00276"></a>00276 <span class="comment">//</span>
<a name="l00277"></a>00277 A.<a class="code" href="../../da/d81/structatom.html#9477300ec23c52f62185edfbad8ccbd5">nVP</a>=1;
<a name="l00278"></a>00278 A.<a class="code" href="../../da/d81/structatom.html#021437b68fe3da8de34ef437c2ae8f56">VP</a>=aap;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 <span class="keywordflow">return</span> A;
<a name="l00281"></a>00281 }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="../../da/d0c/read__prep_8c_3188c5030e980c9b7883c885add832f1_cgraph.gif" border="0" usemap="#da/d0c/read__prep_8c_3188c5030e980c9b7883c885add832f1_cgraph_map" alt=""></center>
<map name="da/d0c/read__prep_8c_3188c5030e980c9b7883c885add832f1_cgraph_map">
<area shape="rect" href="../../dd/dea/mylib_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1)." alt="" coords="156,5,225,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="6be83cebe121fdaa2e3603f8389c39fc"></a><!-- doxytag: member="read_prep.c::read_prepres" ref="6be83cebe121fdaa2e3603f8389c39fc" args="(fileset F, types *TYP)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d7e/structresidue.html">residue</a> read_prepres           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d59/structfileset.html">fileset</a>&nbsp;</td>
          <td class="paramname"> <em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/de2/structtypes.html">types</a> *&nbsp;</td>
          <td class="paramname"> <em>TYP</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="../../de/d85/read__prep_8c-source.html#l00097">97</a> of file <a class="el" href="../../de/d85/read__prep_8c-source.html">read_prep.c</a>.</p>

<p>References <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00113">types::a</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00145">residue::a</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00148">residue::bs</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00144">residue::COM</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00138">residue::D</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00160">residue::d</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00034">fileset::F</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00158">residue::i</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00028">amberrprepinfo::IFIXC</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00026">amberrprepinfo::INTX</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00029">amberrprepinfo::IOMIT</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00034">amberrprepinfo::IOPR</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00031">amberrprepinfo::IPOS</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00030">amberrprepinfo::ISYMDU</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00027">amberrprepinfo::KFORM</a>, <a class="el" href="../../d7/d04/load__pdb_8h-source.html#l00028">line</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00055">atype::m</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00143">residue::m</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00033">fileset::N</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00137">residue::N</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00136">residue::n</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00142">residue::na</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00024">amberrprepinfo::NAMF</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00025">amberrprepinfo::NAMRES</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00147">residue::nbs</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00159">residue::nd</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00157">residue::ni</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00033">amberrprepinfo::nIOPR</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00165">residue::nVP</a>, <a class="el" href="../../d8/d4d/read__eek_8c-source.html#l00006">read_eek()</a>, <a class="el" href="../../de/d85/read__prep_8c-source.html#l00235">read_prepatom()</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00014">llcharset::T</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00107">atom::t</a>, <a class="el" href="../../dc/db8/read__prep_8h-source.html#l00023">amberrprepinfo::TITLE</a>, <a class="el" href="../../da/dff/molecules_8h-source.html#l00166">residue::VP</a>, and <a class="el" href="../../da/d80/zero__vec__crd_8c-source.html#l00019">zero_coord()</a>.</p>

<p>Referenced by <a class="el" href="../../de/d85/read__prep_8c-source.html#l00041">read_prep()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00097"></a>00097                                            { <span class="comment">// will the position be what is expected?</span>
<a name="l00098"></a>00098 <a class="code" href="../../db/d53/structamberrprepinfo.html">amberrprepinfo</a> *arp;
<a name="l00099"></a>00099 <a class="code" href="../../d0/d7e/structresidue.html">residue</a> R;
<a name="l00100"></a>00100 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#c0943872323c1ec7d8f0db57e0bdbbb6">line</a>[501],desc[1001],ctmp[51],ctmp2[51]; <span class="comment">// hope no prep file line is longer than this...</span>
<a name="l00101"></a>00101 <span class="keywordtype">char</span> dumat[21]; <span class="comment">// the symbol used for dummy atoms </span>
<a name="l00102"></a>00102 <span class="keywordtype">char</span> *linestat; <span class="comment">// did the line read work?</span>
<a name="l00103"></a>00103 <span class="keywordtype">int</span> itmp=0,rra=0,rline=0;
<a name="l00104"></a>00104 <span class="keywordtype">char</span> whinetext[1001];
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="comment">// initialize R</span>
<a name="l00107"></a>00107 R.<a class="code" href="../../d0/d7e/structresidue.html#b08e7a7d8bd809c886c81cb1b8266824">n</a>=0; <span class="comment">// residue number given in input file</span>
<a name="l00108"></a>00108 R.<a class="code" href="../../d0/d7e/structresidue.html#79e841122d8d5a17473851e20f18c51e">N</a>=strdup(<span class="stringliteral">""</span>); <span class="comment">// reside name -- can live with residue names of 200 chars or less???  :-)</span>
<a name="l00109"></a>00109 R.<a class="code" href="../../d0/d7e/structresidue.html#82f3cbc693fcd03518cb573775a18519">na</a>=0; <span class="comment">// number of atoms in residue</span>
<a name="l00110"></a>00110 R.<a class="code" href="../../d0/d7e/structresidue.html#e8b142df842ef7e8c6291b426c317cc2">m</a>=0; <span class="comment">// molecular weight</span>
<a name="l00111"></a>00111 R.<a class="code" href="../../d0/d7e/structresidue.html#4055c4b807634b9c37051f892384b63f">COM</a>=<a class="code" href="../../d3/de6/molecules_8h.html#dc0a15e5e592bed33584b4c9814aaf91">zero_coord</a>(); <span class="comment">// center of mass for residue</span>
<a name="l00112"></a>00112 R.<a class="code" href="../../d0/d7e/structresidue.html#35582b318123377171e24d2dc47d5e2a">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>)); <span class="comment">// atom structures (na of these)</span>
<a name="l00113"></a>00113 R.<a class="code" href="../../d0/d7e/structresidue.html#2289f0c047e66f13f68514b9d6b5ad59">nbs</a>=0; <span class="comment">// number of bond sets</span>
<a name="l00114"></a>00114 R.<a class="code" href="../../d0/d7e/structresidue.html#297a055a9c89697b55958892a0c5faa7">bs</a>=(<a class="code" href="../../d6/df4/structbondset.html">bondset</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../d6/df4/structbondset.html">bondset</a>)); <span class="comment">// (consecutive bonds, use these for plotting, etc.)</span>
<a name="l00115"></a>00115 <span class="comment">//int nr; // number of simple rings (no cage structures, etc.)</span>
<a name="l00116"></a>00116 <span class="comment">//int nrbs; // number of ring bondsets defined</span>
<a name="l00117"></a>00117 <span class="comment">//bondset *rbs; // bondsets for rings</span>
<a name="l00118"></a>00118 <span class="comment">//int nrc; // number of ring/reference coordinate sets defined</span>
<a name="l00119"></a>00119 <span class="comment">//coord_3D *rc; // coordinates for ring/reference centers</span>
<a name="l00120"></a>00120 <span class="comment">//int nrp; // number of ring planes defined</span>
<a name="l00121"></a>00121 <span class="comment">//plane *rp; // equations for average/approximate/exact/etc. ring planes (where useful)</span>
<a name="l00122"></a>00122 R.<a class="code" href="../../d0/d7e/structresidue.html#1478dd3eaa2dfef6557daf91a03d423c">ni</a>=1; <span class="comment">// number of other indices</span>
<a name="l00123"></a>00123 R.<a class="code" href="../../d0/d7e/structresidue.html#2f59748194399a6e9317de86e5b4207c">i</a>=(<span class="keywordtype">int</span>*)calloc(R.<a class="code" href="../../d0/d7e/structresidue.html#1478dd3eaa2dfef6557daf91a03d423c">ni</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); <span class="comment">// other indices, as needed (ni of these)</span>
<a name="l00124"></a>00124 R.<a class="code" href="../../d0/d7e/structresidue.html#074ff29a1c28555e4c1f90ae699ba0dc">nd</a>=1; <span class="comment">// number of double-precision parameters</span>
<a name="l00125"></a>00125 R.<a class="code" href="../../d0/d7e/structresidue.html#c429e0758cf2656b7c51cee6ba97223c">d</a>=(<span class="keywordtype">double</span>*)calloc(R.<a class="code" href="../../d0/d7e/structresidue.html#074ff29a1c28555e4c1f90ae699ba0dc">nd</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">// other parameters, as needed (nd of these)</span>
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">// allocate space for prepinfo</span>
<a name="l00128"></a>00128 arp=(<a class="code" href="../../db/d53/structamberrprepinfo.html">amberrprepinfo</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../db/d53/structamberrprepinfo.html">amberrprepinfo</a>));
<a name="l00129"></a>00129 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#7036421becef5a93a6c11f6c29d7b72b">IOPR</a>=(<a class="code" href="../../d9/db0/structllcharset.html">llcharset</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../d9/db0/structllcharset.html">llcharset</a>));
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="comment">// Read residue header information into residue structure</span>
<a name="l00132"></a>00132 <span class="comment">/* A sample header is:</span>
<a name="l00133"></a>00133 <span class="comment">0-[ALPHA-D-ALLO-] terminal, RESP 0.010 HF/6-31Gstar//HF/6-31Gstar</span>
<a name="l00134"></a>00134 <span class="comment">0na.dat</span>
<a name="l00135"></a>00135 <span class="comment">0NA   INT 0</span>
<a name="l00136"></a>00136 <span class="comment">CORRECT OMIT DU BEG</span>
<a name="l00137"></a>00137 <span class="comment"> 0.1940</span>
<a name="l00138"></a>00138 <span class="comment"></span>
<a name="l00139"></a>00139 <span class="comment">By line, they are:</span>
<a name="l00140"></a>00140 <span class="comment">1-2] R.D</span>
<a name="l00141"></a>00141 <span class="comment">3] R.N, error if not INT (for now), error if not zero (for now)</span>
<a name="l00142"></a>00142 <span class="comment">4] error if not "CORRECT", ignore, read in dummy atom name, ignore</span>
<a name="l00143"></a>00143 <span class="comment">5] R.d[0]</span>
<a name="l00144"></a>00144 <span class="comment">*/</span>
<a name="l00145"></a>00145 <span class="comment">// first two lines (description)</span>
<a name="l00146"></a>00146 linestat=fgets(desc,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// first line</span>
<a name="l00147"></a>00147 <span class="comment">//printf("line 1 looks like: &gt;&gt;%s&lt;&lt;\n",desc);</span>
<a name="l00148"></a>00148 <span class="keywordflow">if</span>(linestat==NULL){<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"EOF during residue header read, line 1"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);}
<a name="l00149"></a>00149 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#65d464b499d074016c3ff47f0db66ce8">TITLE</a>=strdup(desc); <span class="comment">// add description to arp (destined for void pointer)</span>
<a name="l00150"></a>00150 R.<a class="code" href="../../d0/d7e/structresidue.html#fa9378e23c46105823b0ec135b8f57b4">D</a>=strdup(desc); <span class="comment">// copy to residue structure</span>
<a name="l00151"></a>00151 linestat=fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// second line</span>
<a name="l00152"></a>00152 <span class="comment">//printf("line 2 looks like: &gt;&gt;%s&lt;&lt;\n",line);</span>
<a name="l00153"></a>00153 <span class="keywordflow">if</span>(linestat==NULL){<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"EOF during residue header read, line 2"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);}
<a name="l00154"></a>00154 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#67183fea16b8deab102d00131f54c503">NAMF</a>=strdup(line);
<a name="l00155"></a>00155 <span class="comment">// next line (name and other)</span>
<a name="l00156"></a>00156 linestat=fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// third line</span>
<a name="l00157"></a>00157 <span class="keywordflow">if</span>(linestat==NULL){<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"EOF during residue header read, line 3"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);}
<a name="l00158"></a>00158 sscanf(line,<span class="stringliteral">"%s %s %d"</span>,desc,ctmp,&amp;itmp);
<a name="l00159"></a>00159 <span class="comment">//printf("line 3 looks like: &gt;&gt;%s&lt;&lt;\n",line);</span>
<a name="l00160"></a>00160 R.<a class="code" href="../../d0/d7e/structresidue.html#79e841122d8d5a17473851e20f18c51e">N</a>=strdup(desc); <span class="comment">// set the residue name</span>
<a name="l00161"></a>00161 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#49b4daa516bb51d726d9c263c1b2c664">NAMRES</a>=strdup(desc);
<a name="l00162"></a>00162 <span class="keywordflow">if</span>(strcmp(ctmp,<span class="stringliteral">"INT"</span>)!=0){<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"entry not INT on line 3 of residue header"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);}
<a name="l00163"></a>00163 <span class="keywordflow">if</span>(itmp!=0){<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"KFORM not zero on line 3 of residue header"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);}
<a name="l00164"></a>00164 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#47c5364024d584af68bad072bdedcf66">INTX</a>=strdup(ctmp);
<a name="l00165"></a>00165 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#02db54f7fc94c6785c9c67dcd5281ec5">KFORM</a>=itmp;
<a name="l00166"></a>00166 <span class="comment">// fourth line (dummy atom symbol &amp; check)</span>
<a name="l00167"></a>00167 linestat=fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// fourth line (dummy atom symbol &amp; check)</span>
<a name="l00168"></a>00168 <span class="keywordflow">if</span>(linestat==NULL)<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"EOF during residue header read, line 4"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);
<a name="l00169"></a>00169 sscanf(line,<span class="stringliteral">"%s %s %s %s"</span>,desc,ctmp,dumat,ctmp2);
<a name="l00170"></a>00170 <span class="keywordflow">if</span>(strcmp(desc,<span class="stringliteral">"CORRECT"</span>)!=0){<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"entry not CORRECT on line 4 of residue header"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>); }
<a name="l00171"></a>00171 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#2f770c5d94253a63e6321b21d63d40ee">IFIXC</a>=strdup(desc);
<a name="l00172"></a>00172 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#d46daa08abf7d292f71946d56a6e9b72">IOMIT</a>=strdup(ctmp);
<a name="l00173"></a>00173 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#4e039bda10624097ca4acb52e021f6f2">ISYMDU</a>=strdup(dumat);
<a name="l00174"></a>00174 arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#111811eb93705fcba226e5d54f0da4c1">IPOS</a>=strdup(ctmp2);
<a name="l00175"></a>00175 <span class="comment">// fifth line (charge on residue)</span>
<a name="l00176"></a>00176 linestat=fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// fourth line (dummy atom symbol &amp; check)</span>
<a name="l00177"></a>00177 <span class="keywordflow">if</span>(linestat==NULL)<a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(<span class="stringliteral">"EOF during residue header read, line 5 (residue charge)"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>);
<a name="l00178"></a>00178 sscanf(line,<span class="stringliteral">"%lf"</span>,&amp;arp[0].CUT);
<a name="l00179"></a>00179 <span class="comment">// scan first three dummy atom lines, make sure that the third field</span>
<a name="l00180"></a>00180 <span class="comment">//      of each is dumat and ignore otherwise (for now, at least)</span>
<a name="l00181"></a>00181 <span class="keywordflow">for</span>(rra=0;rra&lt;3;rra++){
<a name="l00182"></a>00182         linestat=fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>); <span class="comment">// fourth line (dummy atom symbol &amp; check)</span>
<a name="l00183"></a>00183         <span class="keywordflow">if</span>(linestat==NULL){
<a name="l00184"></a>00184                 sprintf(whinetext,<span class="stringliteral">"EOF during residue header read, dummy atom line %d"</span>,(rra+1));
<a name="l00185"></a>00185                 <a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(whinetext,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>); }
<a name="l00186"></a>00186         sscanf(line,<span class="stringliteral">"%s %s %s "</span>,desc,ctmp,ctmp2);
<a name="l00187"></a>00187         <span class="keywordflow">if</span>(strcmp(ctmp2,dumat)!=0){
<a name="l00188"></a>00188 <span class="comment">//printf("\t dumat is &gt;&gt;%s&lt;&lt;, and line looks like: &gt;&gt;%s&lt;&lt;\n",dumat,line);</span>
<a name="l00189"></a>00189                 sprintf(whinetext,<span class="stringliteral">"dummy atom symbol, line %d, does not match declared value"</span>,(rra+1));
<a name="l00190"></a>00190                 <a class="code" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails.">read_eek</a>(whinetext,F.<a class="code" href="../../dc/d59/structfileset.html#c5bad8f08f5d86a5ed63cb40362bada7">N</a>); }
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>)!=NULL){ <span class="comment">// while not end of file</span>
<a name="l00194"></a>00194         rline=1;
<a name="l00195"></a>00195 <span class="comment">//printf("line is: %s\n",line);</span>
<a name="l00196"></a>00196         <span class="keywordflow">for</span>(rra=0;rra&lt;strlen(line);rra++){ <span class="comment">// check for an empty line</span>
<a name="l00197"></a>00197                 <span class="keywordflow">if</span>((line[rra]!=<span class="charliteral">'\t'</span>)&amp;&amp;(line[rra]!=<span class="charliteral">' '</span>)&amp;&amp;(line[rra]!=<span class="charliteral">'\n'</span>)){ <span class="comment">// if this character is NOT a space or tab</span>
<a name="l00198"></a>00198                         rline=0;
<a name="l00199"></a>00199                         <span class="keywordflow">break</span>; } }
<a name="l00200"></a>00200         <span class="keywordflow">if</span>(rline==1) <span class="keywordflow">break</span>;<span class="comment">// if an empty line, break loop</span>
<a name="l00201"></a>00201 <span class="comment">//printf("calling read atom for line: %s\n",line);</span>
<a name="l00202"></a>00202         R.<a class="code" href="../../d0/d7e/structresidue.html#82f3cbc693fcd03518cb573775a18519">na</a>++;<span class="comment">//       allocate space</span>
<a name="l00203"></a>00203         R.<a class="code" href="../../d0/d7e/structresidue.html#35582b318123377171e24d2dc47d5e2a">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>*)realloc(R.<a class="code" href="../../d0/d7e/structresidue.html#35582b318123377171e24d2dc47d5e2a">a</a>,R.<a class="code" href="../../d0/d7e/structresidue.html#82f3cbc693fcd03518cb573775a18519">na</a>*<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>));
<a name="l00204"></a>00204         R.<a class="code" href="../../d0/d7e/structresidue.html#35582b318123377171e24d2dc47d5e2a">a</a>[R.<a class="code" href="../../d0/d7e/structresidue.html#82f3cbc693fcd03518cb573775a18519">na</a>-1]=<a class="code" href="../../d3/d65/read__prep_8h.html#3188c5030e980c9b7883c885add832f1">read_prepatom</a>(line,TYP);<span class="comment">//read_prepatom</span>
<a name="l00205"></a>00205         <span class="comment">// update molecular weight for residue</span>
<a name="l00206"></a>00206         R.<a class="code" href="../../d0/d7e/structresidue.html#e8b142df842ef7e8c6291b426c317cc2">m</a>+=TYP[0].<a class="code" href="../../d5/de2/structtypes.html#12d591c31570aa8ace0e995864f59d96">a</a>[R.<a class="code" href="../../d0/d7e/structresidue.html#35582b318123377171e24d2dc47d5e2a">a</a>[R.<a class="code" href="../../d0/d7e/structresidue.html#82f3cbc693fcd03518cb573775a18519">na</a>-1].<a class="code" href="../../da/d81/structatom.html#0007983fb28310826dfd6851d92b6d4a">t</a>].<a class="code" href="../../dc/d7a/structatype.html#7b33ba31bb5de997c6c19f5dd65a29f2">m</a>;
<a name="l00207"></a>00207         } <span class="comment">// end read of the residue's atoms</span>
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">// while not "DONE", read any after-atoms residue information</span>
<a name="l00210"></a>00210 <span class="keywordflow">while</span>(fgets(line,500,F.<a class="code" href="../../dc/d59/structfileset.html#5b094cf2097c6512b7a3f55c9de9ac25" title="the name of the file -- use strdup to allocate/copy">F</a>)!=NULL){ <span class="comment">// while not end of file</span>
<a name="l00211"></a>00211         rline=1;
<a name="l00212"></a>00212         <span class="keywordflow">for</span>(rra=0;rra&lt;strlen(line);rra++){ <span class="comment">// check for an empty line</span>
<a name="l00213"></a>00213                 <span class="keywordflow">if</span>((line[rra]!=<span class="charliteral">'\t'</span>)&amp;&amp;(line[rra]!=<span class="charliteral">' '</span>)){ <span class="comment">// if this character is NOT a space or tab</span>
<a name="l00214"></a>00214                         rline=0;
<a name="l00215"></a>00215                         <span class="keywordflow">break</span>; } }
<a name="l00216"></a>00216         <span class="keywordflow">if</span>(rline==1) <span class="keywordflow">continue</span>;<span class="comment">// if an empty line, check next line </span>
<a name="l00217"></a>00217         <span class="keywordflow">if</span>((line[0]==<span class="charliteral">'D'</span>)&amp;&amp;(line[1]==<span class="charliteral">'O'</span>)&amp;&amp;(line[2]==<span class="charliteral">'N'</span>)&amp;&amp;(line[3]==<span class="charliteral">'E'</span>)){<span class="keywordflow">break</span>;}
<a name="l00218"></a>00218         arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#4d56342130d4a75398b33977e77bbec9">nIOPR</a>++;
<a name="l00219"></a>00219         arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#7036421becef5a93a6c11f6c29d7b72b">IOPR</a>=(<a class="code" href="../../d9/db0/structllcharset.html">llcharset</a>*)realloc(arp[0].IOPR,arp[0].nIOPR*<span class="keyword">sizeof</span>(<a class="code" href="../../d9/db0/structllcharset.html">llcharset</a>));
<a name="l00220"></a>00220         arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#7036421becef5a93a6c11f6c29d7b72b">IOPR</a>[arp[0].<a class="code" href="../../db/d53/structamberrprepinfo.html#4d56342130d4a75398b33977e77bbec9">nIOPR</a>-1].<a class="code" href="../../d9/db0/structllcharset.html#1374490dc3f31f20eee9ba9c015a6222">T</a>=strdup(line);
<a name="l00221"></a>00221         } <span class="comment">// end scan of post-atom residue info</span>
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="comment">//printf("Residue %s contains %d atoms\n",R.N,R.na);</span>
<a name="l00224"></a>00224 <span class="comment">// for future:</span>
<a name="l00225"></a>00225 <span class="comment">//   scan atom info to set bonding</span>
<a name="l00226"></a>00226 R.<a class="code" href="../../d0/d7e/structresidue.html#f51a2cb5d1a6e88187ed1cb3224e8d86">nVP</a>=1;
<a name="l00227"></a>00227 R.<a class="code" href="../../d0/d7e/structresidue.html#0878f7fac8ebbd8bce4f3c9060bb7f63">VP</a>=arp;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="keywordflow">return</span> R;       
<a name="l00230"></a>00230 }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="../../da/d0c/read__prep_8c_6be83cebe121fdaa2e3603f8389c39fc_cgraph.gif" border="0" usemap="#da/d0c/read__prep_8c_6be83cebe121fdaa2e3603f8389c39fc_cgraph_map" alt=""></center>
<map name="da/d0c/read__prep_8c_6be83cebe121fdaa2e3603f8389c39fc_cgraph_map">
<area shape="rect" href="../../df/da0/group__FILE__UTILS.html#g77e969d3a949fa8aa7195481797b2f19" title="Complains (EEK!!!) if a file read fails." alt="" coords="160,5,229,32"><area shape="rect" href="../../d3/d65/read__prep_8h.html#3188c5030e980c9b7883c885add832f1" title="read_prepatom" alt="" coords="144,56,245,83"><area shape="rect" href="../../d3/de6/molecules_8h.html#dc0a15e5e592bed33584b4c9814aaf91" title="zero_coord" alt="" coords="155,107,235,133"><area shape="rect" href="../../dd/dea/mylib_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1)." alt="" coords="295,56,364,83"></map>
</div>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 11 16:49:10 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
