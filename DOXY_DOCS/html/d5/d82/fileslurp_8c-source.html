<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: src/fileslurp.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000002.html">src</a></div>
<h1>fileslurp.c</h1><a href="../../d5/d83/fileslurp_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/* \file fileslurp.c </span>
00002 <span class="comment">\addtogroup FILE_UTILS</span>
00003 <span class="comment">\brief  Read an entire file into a structure to be processed</span>
00004 <span class="comment">        later within the calling function.</span>
00005 <span class="comment"></span>
00006 <span class="comment">        Argument: A fileset structure.</span>
00007 <span class="comment"></span>
00008 <span class="comment">        Returns: Fileslurp structure containing each line in</span>
00009 <span class="comment">                the file (with newline intact).</span>
00010 <span class="comment"></span>
00011 <span class="comment">        Begun on 20080706 by BLFoley.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/dea/mylib_8h.html">mylib.h</a>&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/d14/general_8h.html">general.h</a>&gt;</span>
00016 <span class="comment">//fileslurp slurp_file(fileset F);</span>
00017 
00018 
<a name="l00019"></a><a class="code" href="../../df/da0/group__FILE__UTILS.html#ga9">00019</a> <a class="code" href="../../d7/d31/structfileslurp.html">fileslurp</a> <a class="code" href="../../df/da0/group__FILE__UTILS.html#ga9">slurp_file</a>(<a class="code" href="../../dc/d59/structfileset.html">fileset</a> F){
00020 <a class="code" href="../../d7/d31/structfileslurp.html">fileslurp</a> S;
00021 <span class="keywordtype">char</span> templine[2001],*line;
00022 <span class="keywordtype">int</span> doneflag=0;
00023 
00024 <span class="comment">// fgets each line in the file, place in temporary hold</span>
00025 <span class="comment">// issue warning if any line is longer than 2000 chars, but</span>
00026 <span class="comment">// finish reading the thing in anyhow.</span>
00027 
00028 <span class="comment">// open the file</span>
00029 F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>=<a class="code" href="../../df/da0/group__FILE__UTILS.html#ga0">myfopen</a>(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>,<span class="stringliteral">"r"</span>);
00030 <span class="comment">// read the file</span>
00031 S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo0">n</a>=0;
00032 S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo1">L</a>=(<span class="keywordtype">char</span>**)calloc(1,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
00033 <span class="keywordflow">while</span>(fgets(templine,2000,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00034         <a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>=strdup(templine);
00035         <span class="keywordflow">if</span>(strchr(templine,<span class="charliteral">'\n'</span>)==NULL){ <span class="comment">// got a line over 2000 chars</span>
00036                 fprintf(stderr,<span class="stringliteral">"found line over 2000 chars in file "</span>);
00037                 fprintf(stderr,<span class="stringliteral">"%s at line %d. reading anyway.\n"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>,(S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo0">n</a>+1));
00038                 doneflag=1;
00039                 <span class="keywordflow">while</span>(doneflag==1){
00040                         fgets(templine,2000,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00041         <a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>=(<span class="keywordtype">char</span>*)realloc(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,(strlen(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>)+strlen(templine)+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
00042                         strcat(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,templine);
00043                         <span class="keywordflow">if</span>(strchr(templine,<span class="charliteral">'\n'</span>)!=NULL){doneflag=0;}
00044                         }
00045                 }
00046         S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo0">n</a>++;
00047         S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo1">L</a>=(<span class="keywordtype">char</span>**)realloc(S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo1">L</a>,S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo0">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
00048         S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo1">L</a>[S.<a class="code" href="../../d7/d31/structfileslurp.html#fileslurpo0">n</a>-1]=strdup(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>);
00049         } <span class="comment">// close the while loop</span>
00050 
00051 <span class="keywordflow">return</span> S;
00052 } 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jul 22 12:10:50 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
