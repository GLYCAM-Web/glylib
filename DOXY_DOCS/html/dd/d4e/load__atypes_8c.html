<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: src/load_atypes.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000002.html">src</a></div>
<h1>load_atypes.c File Reference</h1><code>#include &lt;<a class="el" href="../../d8/d8f/mylib_8h-source.html">mylib.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d5/d31/general_8h-source.html">general.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../da/dff/molecules_8h-source.html">molecules.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d9/dc7/declarations_8h-source.html">declarations.h</a>&gt;</code><br>

<p>
Include dependency graph for load_atypes.c:<p><center><img src="../../d1/db0/load__atypes_8c__incl.png" border="0" usemap="#load_atypes.c_map" alt="Include dependency graph"></center>
<map name="load_atypes.c_map">
<area href="../../dd/dea/mylib_8h.html" shape="rect" coords="357,80,421,107" alt="">
<area href="../../d9/d14/general_8h.html" shape="rect" coords="607,80,684,107" alt="">
<area href="../../d3/de6/molecules_8h.html" shape="rect" coords="708,80,799,107" alt="">
<area href="../../d4/ddb/geometries_8h.html" shape="rect" coords="704,5,803,32" alt="">
<area href="../../d1/d10/parameter__sets_8h.html" shape="rect" coords="827,5,952,32" alt="">
<area href="../../db/d40/declarations_8h.html" shape="rect" coords="823,80,927,107" alt="">
</map>

<p>
<a href="../../d7/d2d/load__atypes_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d4e/load__atypes_8c.html#a0">load_atypes</a> (<a class="el" href="../../dc/d59/structfileset.html">fileset</a> F, <a class="el" href="../../d5/de2/structtypes.html">types</a> *T)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="load_atypes.c::load_atypes"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void load_atypes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d59/structfileset.html">fileset</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/de2/structtypes.html">types</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2d/load__atypes_8c-source.html#l00015">15</a> of file <a class="el" href="../../d7/d2d/load__atypes_8c-source.html">load_atypes.c</a>.
<p>
References <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00108">types::a</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00053">atype::bo</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00051">atype::desc</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00028">fileset::F</a>, <a class="el" href="../../d7/d04/load__pdb_8h-source.html#l00021">line</a>, <a class="el" href="../../d9/dc2/myfopen_8c-source.html#l00025">myfreopen()</a>, <a class="el" href="../../d7/d30/mywhine_8c-source.html#l00007">mywhine()</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00048">atype::N</a>, <a class="el" href="../../d5/d31/general_8h-source.html#l00027">fileset::N</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00107">types::na</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00052">atype::nb</a>, <a class="el" href="../../d5/d69/parameter__sets_8h-source.html#l00049">atype::NT</a>, and <a class="el" href="../../d8/d4d/read__eek_8c-source.html#l00006">read_eek()</a>.<div class="fragment"><pre class="fragment">00015                                      {
00016 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#a4">line</a>[10001],*entry;
00017 <span class="keywordtype">int</span> test=0,la=0,numbnd=0;
00018 F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>=<a class="code" href="../../de/de6/myfopen_8c.html#a1">myfreopen</a>(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>,<span class="stringliteral">"r"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>); <span class="comment">// don't depend on calling function to have opened</span>
00019 <span class="keywordflow">while</span>(fgets(line,10000,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){<span class="comment">// while not end of file</span>
00020         <span class="keywordflow">if</span>(<a class="code" href="../../d7/d40/load__pdb_8h.html#a4">line</a>[0]!=<span class="charliteral">'#'</span>){<span class="comment">//check that the line does not start with a hash </span>
00021                 <span class="keywordflow">if</span>(strchr(line,EOF)!=NULL){<a class="code" href="../../d9/dd3/read__eek_8c.html#a0">read_eek</a>(<span class="stringliteral">"EOF"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);}
00022                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>++;<span class="comment">// increment and allocate</span>
00023                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>=(<a class="code" href="../../dc/d7a/structatype.html">atype</a>*)realloc(T[0].a,T[0].na*<span class="keyword">sizeof</span>(<a class="code" href="../../dc/d7a/structatype.html">atype</a>));
00024                 <span class="comment">// read data into structure by splitting on the : token</span>
00025                 <span class="comment">//strcpy(entry,strtok(line,":")); // get atomic number</span>
00026                 test=sscanf(strtok(line,<span class="stringliteral">":"</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].n);
00027                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading atomic number"</span>);}
00028                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo1">N</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get atom name</span>
00029                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo2">NT</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get element name</span>
00030                 <span class="comment">//strcpy(entry,strtok(NULL,":")); // get mass</span>
00031                 test=sscanf(strtok(NULL,<span class="stringliteral">":"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].m);
00032                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading atomic mass"</span>);}
00033                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo4">desc</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get description </span>
00034                 entry=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get bonding info </span>
00035                 test=sscanf(strtok(NULL,<span class="stringliteral">":"</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].nlp);<span class="comment">// get number lone pairs</span>
00036                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading number of lone pairs"</span>);}
00037                 <span class="comment">// split bonding info</span>
00038                 <span class="keywordflow">if</span>(strchr(entry,<span class="charliteral">'('</span>)==NULL){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: bonding field does not contain bond orders"</span>);}
00039                 test=sscanf(strtok(entry,<span class="stringliteral">"("</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].nb);<span class="comment">// get number typical bonds</span>
00040                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading number of typical bonds"</span>);}
00041                 numbnd=T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo5">nb</a>;
00042                 <span class="keywordflow">if</span>(numbnd==0){
00043                         numbnd=1;
00044                         T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>=(<span class="keywordtype">double</span>*)calloc(1,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00045                         test=sscanf(strtok(NULL,<span class="stringliteral">",)"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].bo[0]);<span class="comment">// get bond order</span>
00046                         <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading bond order"</span>);}
00047                         <span class="keywordflow">if</span>(T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>[0]!=0) T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo5">nb</a>=-1;
00048                         }
00049                 <span class="keywordflow">else</span>{
00050                         T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>=(<span class="keywordtype">double</span>*)calloc(numbnd,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00051                         <span class="keywordflow">for</span>(la=0;la&lt;numbnd;la++){
00052                                 test=sscanf(strtok(NULL,<span class="stringliteral">",)"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].bo[la]);<span class="comment">// get bond order</span>
00053                                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading bond order"</span>);}
00054                                 } 
00055                         }
00056                 } <span class="comment">// close if line is not a comment</span>
00057         }<span class="comment">// close while not EOF</span>
00058 <span class="comment">// return; </span>
00059 <span class="keywordflow">return</span>;
00060 }
</pre></div>
<p>
    </td>
  </tr>
</table>

<p>
Here is the call graph for this function:<p><center><img src="../../dd/d4e/load__atypes_8c_a0_cgraph.png" border="0" usemap="#dd/d4e/load__atypes_8c_a0_cgraph_map" alt=""></center>
<map name="dd/d4e/load__atypes_8c_a0_cgraph_map">
<area href="../../de/de6/myfopen_8c.html#a1" shape="rect" coords="148,5,231,32" alt="">
<area href="../../d9/d66/mywhine_8c.html#a0" shape="rect" coords="153,56,225,83" alt="">
<area href="../../d9/dd3/read__eek_8c.html#a0" shape="rect" coords="151,107,228,133" alt="">
</map>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jul 21 18:20:41 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
