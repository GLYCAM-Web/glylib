<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: src/load_dlg_mol.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000002.html">src</a></div>
<h1>load_dlg_mol.c</h1><a href="../../d2/dc6/load__dlg__mol_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/* File load_dlg_mol.c begun on 20071015 by BLFoley</span>
00002 <span class="comment"> * Function load_dlg_mol: loads AutoDock dlg output into a</span>
00003 <span class="comment"> *      molecule structure, placing the initial structure in</span>
00004 <span class="comment"> *      the main coordinate set and the docked structures into</span>
00005 <span class="comment"> *      alternate coordinate sets.  Also calculates COM for</span>
00006 <span class="comment"> *      the main molecule and each residue (initial and docked).</span>
00007 <span class="comment">*/</span>
00008 <span class="preprocessor">#include "../inc/mylib.h"</span>
00009 <span class="preprocessor">#include "../inc/general.h"</span>
00010 <span class="preprocessor">#include "../inc/molecules.h"</span>
00011 <span class="preprocessor">#include "../inc/declarations.h"</span>
00012 
00013 <span class="comment">//dockinfo *load_dlg_mol(fileset F,atype *AT);</span>
00014 
<a name="l00015"></a><a class="code" href="../../d2/dc6/load__dlg__mol_8c.html#a0">00015</a> <a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a> *<a class="code" href="../../d2/dc6/load__dlg__mol_8c.html#a0">load_dlg_mol</a>(<a class="code" href="../../dc/d59/structfileset.html">fileset</a> F,<a class="code" href="../../d5/de2/structtypes.html">types</a> *T){
00016 <span class="keywordtype">int</span> a=0,b=-1000,anum=0,rnum=0,ndock=0,ai=0,di=0,ri=0,ti=0;
00017 <span class="keywordtype">int</span> scntst=0,*AI,nat=0,localdebug=1;
00018 <span class="keywordtype">int</span> fRes = -1;
00019 fpos_t* start = (fpos_t*)calloc(1,<span class="keyword">sizeof</span>(fpos_t));
00020 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>[501],dum1[50],dum2[50],at[10],res[10]; <span class="comment">// maybe no lines longer than 500...</span>
00021 <span class="keywordtype">char</span> whinetext[501];
00022 <span class="keywordtype">double</span> x=0,y=0,z=0,xl=0,xh=0,yl=0,yh=0,zl=0,zh=0;
00023 <a class="code" href="../../dc/d7a/structatype.html">atype</a>* AT = T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>;
00024 <a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a> *D;
00025 
00026 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: At top.\n"</span>);}
00027 <span class="comment">// initialize some stuff</span>
00028 D=(<a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../de/da3/structdockinfo.html">dockinfo</a>));
00029 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>=1;
00030 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>=0;
00031 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>=(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7e/structresidue.html">residue</a>));
00032 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>=0;
00033 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>=(<a class="code" href="../../da/d81/structatom.html">atom</a>*)calloc(1,<span class="keyword">sizeof</span>(<a class="code" href="../../da/d81/structatom.html">atom</a>));
00034 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>=0;
00035 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[0].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>=0;
00036 <span class="comment">//if(localdebug&gt;1){dprint_molecule(&amp;D[0].M,10);}</span>
00037 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: After init.\n"</span>);}
00038 rewind(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00039 <span class="comment">// find the start of the input PDBQ file</span>
00040 <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00041 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"line is &gt;&gt;&gt;%s&lt;&lt;&lt;\n"</span>,<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>);}
00042         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"INPUT PDBQ FILE"</span>)!=NULL){
00043                 fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00044                 fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00045                 <span class="keywordflow">break</span>;
00046                 }}
00047 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: After found PDBQ.\n"</span>);}
00048 <span class="comment">//Find the smallest residue number</span>
00049 fgetpos(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>,start);
00050 <span class="keywordflow">while</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"__________________________________"</span>) == NULL){
00051         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"INPUT-PDBQ: ATOM"</span>)!=NULL){
00052                 scntst=sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %d %s %s %d"</span>,dum1,dum2,&amp;anum,at,res,&amp;rnum);
00053                 <span class="keywordflow">if</span>(rnum &lt; fRes || fRes &lt; 0)
00054                         fRes = rnum;
00055         }
00056         fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>);
00057 }
00058 fRes -= 1;
00059 fsetpos(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>,start);
00060 free(start);
00061 <span class="comment">// read in the PDBQ info to the structure</span>
00062 <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00063 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"load_dlg_mol: Reading file.\n"</span>);}
00064 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"line is &gt;&gt;&gt;%s&lt;&lt;&lt;\n"</span>,<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>);}
00065         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"INPUT-PDBQ"</span>)!=NULL){
00066 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"load_dlg_mol: Reading PDBQ.\n"</span>);}
00067                 <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"INPUT-PDBQ: ATOM"</span>)!=NULL){
00068                         scntst=sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %d %s %s %d %lf %lf %lf"</span>,\
00069                                 dum1,dum2,&amp;anum,at,res,&amp;rnum,&amp;x,&amp;y,&amp;z);
00070 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"line is &gt;&gt;&gt;%s&lt;&lt;&lt;\n"</span>,<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>);}
00071                         rnum-=fRes;
00072                         <span class="keywordflow">if</span>(scntst!=9){<a class="code" href="../../df/da0/group__FILE__UTILS.html#ga2">read_eek</a>(<span class="stringliteral">"end of line while reading INPUT-PDBQ: ATOM"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);}
00073                         <span class="keywordflow">if</span>(b==-1000){
00074                                 xl=xh=x; 
00075                                 yl=yh=y; 
00076                                 zl=zh=z; 
00077                                 b=0;
00078                                 }
00079                         <span class="keywordflow">else</span>{
00080                                 <span class="keywordflow">if</span>(x&lt;xl){xl=x;}
00081                                 <span class="keywordflow">if</span>(x&gt;xh){xh=x;}
00082                                 <span class="keywordflow">if</span>(y&lt;yl){yl=y;}
00083                                 <span class="keywordflow">if</span>(y&gt;yh){yh=y;}
00084                                 <span class="keywordflow">if</span>(z&lt;zl){zl=z;}
00085                                 <span class="keywordflow">if</span>(z&gt;zh){zh=z;}
00086                                 }
00087                         <span class="keywordflow">if</span>(rnum&gt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>){
00088 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: need more space for rnum -- assigning\n"</span>);}
00089                                 ri=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>; <span class="comment">// number already allocated</span>
00090                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>=rnum;
00091                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>=(residue*)realloc(D[0].M.r,rnum*<span class="keyword">sizeof</span>(residue));
00092                                 <span class="keywordflow">for</span>(b=ri;b&lt;rnum;b++){
00093                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>=0;
00094                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>=0;
00095                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo1">N</a> = (<span class="keywordtype">char</span>*)calloc(11,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
00096                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo2">D</a> = NULL;
00097                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo12">bs</a> = NULL;
00098                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo15">rbs</a> = NULL;
00099                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a> = NULL;
00100                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo19">rp</a> = NULL;
00101                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo21">i</a> = NULL;
00102                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo23">d</a> = NULL;
00103                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo29">VP</a> = NULL;
00104                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo1">N</a>[0]=<span class="charliteral">'\0'</span>;
00105                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo22">nd</a> = 0;
00106                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo20">ni</a> = 0;
00107                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo13">nr</a> = 0;
00108                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo18">nrp</a> = 0;
00109                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo16">nrc</a> = 0;
00110                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo14">nrbs</a> = 0;
00111                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo11">nbs</a> = 0;
00112                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo28">nVP</a> = 0;
00113                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>=(atom*)calloc(1,<span class="keyword">sizeof</span>(atom)); 
00114                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo18">ni</a>=0;
00115                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo7">nb</a>=0;
00116                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo9">nmb</a>=0;
00117                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo12">nalt</a>=0;
00118                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[b].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[0].<a class="code" href="../../da/d81/structatom.html#atomo14">nvec</a>=0;
00119                                         }
00120 <span class="comment">//if(localdebug&gt;1){dprint_molecule(&amp;D[0].M,10);}</span>
00121                                 }
00122                         ri=rnum-1;
00123                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo0">n</a>=rnum+fRes;<span class="comment">//Set the residue number</span>
00124 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: ri is %d ; D[0].M.r[ri].N is &gt;&gt;%s&lt;&lt;\n"</span>,ri,D[0].M.r[ri].N);}
00125                         <span class="comment">//if(D[0].M.r[ri].na==0){ strcpy(D[0].M.r[ri].N,res); }</span>
00126                         <span class="keywordflow">if</span>(D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>==0){ D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo1">N</a> = strdup(res); }
00127                         <span class="keywordflow">else</span>{<span class="keywordflow">if</span>(strcmp(D[0].M.r[ri].N,res)!=0){
00128                                 sprintf(whinetext,<span class="stringliteral">"residue name mismatch reading initial PDBQ\n\</span>
00129 <span class="stringliteral">between read residue &gt;&gt;%s&lt;&lt; and comparison residue (D[0].M.r[%d].N &gt;&gt;%s&lt;&lt;)"</span>,res,ri,D[0].M.r[ri].N);
00130                                 <a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(whinetext);}}
00131                         ai=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>; <span class="comment">// atom index, for convenience</span>
00132                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>++;
00133                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>++;
00134                         <span class="keywordflow">if</span>(anum&gt;nat){nat=anum;}; <span class="comment">// overall atom count</span>
00135                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>=(atom*)realloc(D[0].M.r[ri].a,(ai+1)*<span class="keyword">sizeof</span>(atom));
00136                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo18">ni</a>=0;
00137                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo7">nb</a>=0;
00138                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo9">nmb</a>=0;
00139                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo12">nalt</a>=0;
00140                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo14">nvec</a>=0;
00141                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>=anum;
00142                         <span class="comment">//strcpy(D[0].M.r[ri].a[ai].N,at);</span>
00143                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo1">N</a> = strdup(at);
00144 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: ri is %d ; ai is %d ; D[0].M.r[ri].a[ai].N is &gt;&gt;%s&lt;&lt;\n"</span>,ri,ai,D[0].M.r[ri].a[ai].N);}
00145                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=x;
00146                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=y;
00147                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=z;
00148                         <span class="keywordflow">for</span>(b=0;b&lt;T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>;b++){ <span class="comment">// might be a problem, the NUMAT(fixed)</span>
00149                                 <span class="keywordflow">if</span>(at[0]==AT[b].<a class="code" href="../../dc/d7a/structatype.html#atypeo2">NT</a>[0]){
00150                                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo4">t</a>=b;
00151                                         ti=b; <span class="comment">// for convenience</span>
00152                                         <span class="keywordflow">break</span>;
00153                                         }
00154                                 }
00155                         <span class="comment">// add to the COM determinations</span>
00156                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>+=AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// add to molecule MW</span>
00157                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// molecule COM</span>
00158                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00159                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00160                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>+=AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// add to residue MW</span>
00161                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// residue COM</span>
00162                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00163                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00164 <span class="keywordflow">if</span>(localdebug&gt;1){printf(<span class="stringliteral">"\tload_dlg_mol: ri = %d ; ai = %d (%s) type %s mass %f  (running= %f )\n"</span>,ri,ai,D[0].M.r[ri].a[ai].N,AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo1">N</a>,AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>);}
00165 <span class="keywordflow">if</span>(localdebug&gt;1){printf(<span class="stringliteral">"\tload_dlg_mol: res main x y z is %20.15e  %20.15e  %20.15e \n"</span>,D[0].M.r[ri].a[ai].x.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);}
00166 <span class="keywordflow">if</span>(localdebug&gt;1){printf(<span class="stringliteral">"\tload_dlg_mol: running COM is %20.15e  %20.15e  %20.15e \n"</span>,D[0].M.r[ri].COM.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);}
00167                         }
00168 <span class="comment">//if(localdebug&gt;1){dprint_molecule(&amp;D[0].M,10);}</span>
00169                 }
00170         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Number of atoms found in molecule"</span>)!=NULL){<span class="keywordflow">break</span>;} 
00171         }
00172 <span class="comment">// ONE DAY:  add in any missing atoms</span>
00173 <span class="comment">// -- open the prep database</span>
00174 <span class="comment">// -- scan for the residue name</span>
00175 <span class="comment">// -- record number/name/type of atoms</span>
00176 <span class="comment">// -- mark as present or not, etc...</span>
00177 <span class="comment">//</span>
00178 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: About to start COM calc.\n"</span>);}
00179 <span class="comment">// finish COM calculation for molecule</span>
00180 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00181 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00182 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00183 <span class="comment">//printf("center of mass (MW=%20.12e) is at: %20.12e %20.12e %20.12e \n",D[0].M.COM.i,D[0].M.COM.j,D[0].M.COM.k);</span>
00184 <span class="comment">// also for the residues -- plus record atom number correlation</span>
00185 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: continuing residue-level COM calc.\n"</span>);}
00186 AI=(<span class="keywordtype">int</span>*)calloc(nat,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
00187 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){ 
00188         <span class="keywordflow">if</span>(D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>==0){
00189                 sprintf(whinetext,<span class="stringliteral">"lack of atoms in residue &gt;&gt;%s&lt;&lt;, number %d"</span>,D[0].M.r[a].N,(a+1));
00190                 <a class="code" href="../../df/da0/group__FILE__UTILS.html#ga2">read_eek</a>(whinetext,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);
00191                 }
00192         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00193         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00194         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00195 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"\tload_dlg_mol: about to set ai indices.\n"</span>);}
00196         <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>;b++){
00197                 <span class="keywordflow">if</span>(D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>&gt;nat){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"problem counting atoms (n) in load_dlg"</span>);}
00198                 AI[D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>-1]=b;
00199                 }
00200         }
00201 
00202 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: Scanning to dockings.\n"</span>);}
00203 <span class="comment">// read in the alternate coordinate sets</span>
00204 <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00205         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Number of requested LGA dockings"</span>)!=NULL){
00206 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"load_dlg_mol: line is &gt;&gt;%s&lt;&lt;\n"</span>,<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>);} 
00207                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Number of requested LGA dockings = %d "</span>,&amp;ndock);
00208 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: ndock is &gt;&gt;%d&lt;&lt;\n"</span>,ndock);} 
00209                 <span class="keywordflow">break</span>; }}
00210 <span class="comment">// allocate the memory -- use the internal ring coordinates to hold</span>
00211 <span class="comment">// the extra centers of mass</span>
00212 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: About to allocate; ndock is %d.\n"</span>,ndock);}
00213 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>=0;
00214 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo1">n</a>=ndock;
00215 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo3">TR</a>=(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d31/structcoord__3D.html">coord_3D</a>));<span class="comment">//translation for docked structure</span>
00216 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo4">Q</a>=(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>*)calloc(ndock,<span class="keyword">sizeof</span>(<a class="code" href="../../d3/df7/structvectormag__3D.html">vectormag_3D</a>));<span class="comment">// Quaternion x,y,z,w</span>
00217 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo5">QN</a>=(vectormag_3D*)calloc(ndock,<span class="keyword">sizeof</span>(vectormag_3D));<span class="comment">// Quaternion nx,ny,nz,angle</span>
00218 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo6">QN0</a>=(vectormag_3D*)calloc(ndock,<span class="keyword">sizeof</span>(vectormag_3D));<span class="comment">// quat0 nx,ny,nz,angle</span>
00219 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo9">eFEB</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// Est. Free Energy of Binding, kcal/mol [=(1)+(3)]</span>
00220 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo10">eKi</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// Est. Inhibition Const. Ki </span>
00221 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo11">Tmp</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// temperature, Kelvin</span>
00222 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo12">fDE</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// Final Docked Energy, kcal/mol [=(1)+(2)]</span>
00223 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo13">fIE</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// (1) Final Intermolecular Energy</span>
00224 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo14">fIEL</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// (2) Final Internal Energy of Ligand</span>
00225 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo15">TFE</a>=(<span class="keywordtype">double</span>*)calloc(ndock,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));<span class="comment">// (3) Torsional Free Energy </span>
00226 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo18">nrc</a>=ndock;
00227 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>=(coord_3D*)calloc(ndock,<span class="keyword">sizeof</span>(coord_3D)); <span class="comment">// for alt struct mol COM's</span>
00228 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){
00229         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo16">nrc</a>=ndock;
00230         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>=(coord_3D*)calloc(ndock,<span class="keyword">sizeof</span>(coord_3D)); <span class="comment">// for alt struct res COM's</span>
00231         <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo6">na</a>;b++){
00232                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo12">nalt</a>=ndock;
00233                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[b].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>=(coord_3D*)calloc(ndock,<span class="keyword">sizeof</span>(coord_3D));
00234                 }
00235         }
00236 
00237 
00238 <span class="keywordflow">if</span>(localdebug&gt;0){printf(<span class="stringliteral">"load_dlg_mol: About to read alternate sets.\n"</span>);}
00239 <span class="comment">// read in the docked structures</span>
00240 di=-1; <span class="comment">// index to check that all docked structures were found</span>
00241 <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00242         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"FINAL LAMARCKIAN GENETIC ALGORITHM DOCKED STATE"</span>)!=NULL){
00243 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; about to read energy info.\n"</span>);}
00244         di++;
00245         <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00246                 <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"DOCKED: USER                           _______"</span>)!=NULL){<span class="keywordflow">break</span>;}
00247                 <span class="keywordflow">else</span>{
00248                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Quaternion nx,ny,nz,angle"</span>)!=NULL){
00249                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %lf %lf %lf %lf"</span>,dum1,dum1,dum1,\
00250                                         &amp;D[0].QN[di].i,&amp;D[0].QN[di].j,&amp;D[0].QN[di].k,&amp;D[0].QN[di].d); 
00251                                 }
00252                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Quaternion x,y,z,w "</span>)!=NULL){
00253                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %lf %lf %lf %lf"</span>,dum1,dum1,dum1,\
00254                                         &amp;D[0].Q[di].i,&amp;D[0].Q[di].j,&amp;D[0].Q[di].k,&amp;D[0].Q[di].d); 
00255                                 }
00256                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Estimated Free Energy of Binding "</span>)!=NULL){
00257                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,\
00258                                         dum1,dum1,dum1,dum1,&amp;D[0].eFEB[di]);
00259                                 }
00260                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Estimated Inhibition Constant, Ki"</span>)!=NULL){
00261                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %s %s %s %lf %s %s %lf"</span>,dum1,dum1,dum1,dum1,\
00262                                         dum1,dum1,dum1,&amp;D[0].eKi[di],dum1,dum1,&amp;D[0].Tmp[di]);
00263                                 }
00264                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Final Docked Energy"</span>)!=NULL){
00265                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,dum1,dum1,\
00266                                         &amp;D[0].fDE[di]);
00267                                 }
00268                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Final Intermolecular Energy"</span>)!=NULL){
00269                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,dum1,\
00270                                         dum1,dum1,&amp;D[0].fIE[di]);
00271                                 }
00272                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Final Internal Energy of Ligand"</span>)!=NULL){
00273                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,\
00274                                         dum1,dum1,dum1,dum1,dum1,dum1,&amp;D[0].fIEL[di]);
00275                                 }
00276                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"Torsional Free Energy"</span>)!=NULL){
00277                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %s %s %s %lf"</span>,dum1,dum1,dum1,dum1,\
00278                                         dum1,dum1,dum1,&amp;D[0].TFE[di]);
00279                                 }
00280                         <span class="keywordflow">if</span>((strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"NEWDPF about"</span>)!=NULL)&amp;&amp;(di==0)){
00281                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %lf %lf %lf"</span>,dum1,dum1,dum1,dum1,\
00282                                         &amp;D[0].RC.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,&amp;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo2">RC</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,&amp;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo2">RC</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>); 
00283                                 }
00284                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"NEWDPF tran0 "</span>)!=NULL){
00285                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %lf %lf %lf"</span>,dum1,dum1,dum1,dum1,\
00286                                         &amp;D[0].TR[di].i,&amp;D[0].TR[di].j,&amp;D[0].TR[di].k);
00287                                 }
00288                         <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"NEWDPF quat0"</span>)!=NULL){
00289                                 sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %s %s %lf %lf %lf %lf"</span>,dum1,dum1,dum1,dum1,\
00290                                         &amp;D[0].QN0[di].i,&amp;D[0].QN0[di].j,&amp;D[0].QN0[di].k,&amp;D[0].QN0[di].d); 
00291                                 }
00292                         }
00293                 }
00294         nat=0;
00295 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; about to read coordinates.\n"</span>);}
00296         <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,500,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){
00297                 <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"DOCKED: ATOM"</span>)!=NULL){
00298 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; in atom scan.\n"</span>);}
00299                         nat++;
00300                         scntst=sscanf(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"%s %s %d %s %s %d %lf %lf %lf"</span>,\
00301                                 dum1,dum2,&amp;anum,at,res,&amp;rnum,&amp;x,&amp;y,&amp;z);
00302                         <span class="comment">//if(rnum&gt;3020){rnum%=3020;}//Added to handle LSTC_1918 (Temporary)</span>
00303                         rnum-=fRes;
00304                         <span class="keywordflow">if</span>(scntst!=9){
00305                                 sprintf(whinetext,<span class="stringliteral">"end of line while reading DOCKED: ATOM (run %d)"</span>,(di+1));
00306                                 <a class="code" href="../../df/da0/group__FILE__UTILS.html#ga2">read_eek</a>(whinetext,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);}
00307                         <span class="keywordflow">if</span>(x&lt;xl){xl=x;}
00308                         <span class="keywordflow">if</span>(x&gt;xh){xh=x;}
00309                         <span class="keywordflow">if</span>(y&lt;yl){yl=y;}
00310                         <span class="keywordflow">if</span>(y&gt;yh){yh=y;}
00311                         <span class="keywordflow">if</span>(z&lt;zl){zl=z;}
00312                         <span class="keywordflow">if</span>(z&gt;zh){zh=z;}
00313                         ri=rnum-1;
00314                         <span class="keywordflow">if</span>(strcmp(D[0].M.r[ri].N,res)!=0){
00315                                 sprintf(whinetext,<span class="stringliteral">"residue name mismatch reading DOCKED: ATOM (run %d)"</span>,(di+1));
00316                                 <a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(whinetext); }
00317                         ai=AI[anum-1]; <span class="comment">// atom index</span>
00318 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: anum=%d ; ri=%d ; ai=%d ; di=%d.\n"</span>,anum,ri,ai,di);}
00319                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=x;
00320                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=y;
00321                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=z;
00322                         ti=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo4">t</a>; <span class="comment">// for convenience</span>
00323                         <span class="comment">// add to the COM determinations</span>
00324                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// molecule COM</span>
00325                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00326                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00327                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>; <span class="comment">// residue COM</span>
00328                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00329                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>+=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[ri].<a class="code" href="../../d0/d7e/structresidue.html#residueo9">a</a>[ai].<a class="code" href="../../da/d81/structatom.html#atomo13">xa</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>*AT[ti].<a class="code" href="../../dc/d7a/structatype.html#atypeo3">m</a>;
00330                         }
00331                 <span class="keywordflow">if</span>(strstr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">"DOCKED: ENDMDL"</span>)!=NULL){ 
00332                         <span class="comment">// finish COM calculation for molecule</span>
00333 <span class="keywordflow">if</span>(localdebug&gt;3){printf(<span class="stringliteral">"\tload_dlg_mol: found a set; in COM calc.\n"</span>);}
00334                         <span class="keywordflow">if</span>(nat!=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>){
00335                                 sprintf(whinetext,<span class="stringliteral">"didn't find enough atoms in run %d"</span>,(di+1));
00336                                 <a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(whinetext);}
00337                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00338                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00339                         D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo3">m</a>;
00340 <span class="comment">//printf("center of mass (MW=%20.12e) is at: %20.12e %20.12e %20.12e \n",D[0].M.COM.i,D[0].M.COM.j,D[0].M.COM.k);</span>
00341                         <span class="comment">// also for the residues -- plus record atom number correlation</span>
00342                         <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){ 
00343                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00344                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00345                                 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[di].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>/=D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo7">m</a>;
00346                                 }
00347                         <span class="keywordflow">break</span>; <span class="comment">// leave this while read loop</span>
00348                         }
00349                 } <span class="comment">// close while read DOCKED info</span>
00350                 } <span class="comment">// close if FINAL LAMARCKIAN etc.</span>
00351         } <span class="comment">// close overall read through file while-fgets line</span>
00352 
00353 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo20">boxl</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=xl;
00354 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo20">boxl</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=yl;
00355 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo20">boxl</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=zl;
00356 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo21">boxh</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>=xh;
00357 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo21">boxh</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>=yh;
00358 D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo21">boxh</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>=zh;
00359 
00360 <span class="keywordflow">if</span>(localdebug==2){
00361         <a class="code" href="../../df/d0b/dXprint__X_8c.html#a8">dXprint_molecule</a>(&amp;D[0].M,5);
00362         <a class="code" href="../../df/d0b/dXprint__X_8c.html#a0">dXprint_coord_3D</a>(&amp;D[0].M.boxl);
00363         <a class="code" href="../../df/d0b/dXprint__X_8c.html#a0">dXprint_coord_3D</a>(&amp;D[0].M.boxh);
00364         }
00365 <span class="keywordflow">if</span>(localdebug&gt;2){<a class="code" href="../../df/d0b/dXprint__X_8c.html#a8">dXprint_molecule</a>(&amp;D[0].M,150);}
00366 
00367 <span class="keywordflow">if</span>(localdebug&gt;1){
00368 printf(<span class="stringliteral">"Molecule COM (main) is %20.15e %20.15e %20.15e\n"</span>,D[0].M.COM.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo7">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00369 printf(<span class="stringliteral">"\tThere are %d alternate COM's:\n"</span>,D[0].M.nrc);
00370 <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo18">nrc</a>;b++){
00371 printf(<span class="stringliteral">"\t\tCOM (alt %d) is %20.15e %20.15e %20.15e\n"</span>,b,D[0].M.rc[b].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo19">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00372 }
00373 printf(<span class="stringliteral">"\tThere are %d Residues:\n"</span>,D[0].M.nr); 
00374 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){
00375 printf(<span class="stringliteral">"\t\tmain COM (RES %d) is %20.15e %20.15e %20.15e\n"</span>,a,D[0].M.r[a].COM.<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo8">COM</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00376 }
00377 printf(<span class="stringliteral">"\t ...each with %d alternate COM's:\n"</span>,D[0].M.nrc); 
00378 <span class="keywordflow">for</span>(a=0;a&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;a++){
00379 <span class="keywordflow">for</span>(b=0;b&lt;D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo16">nrc</a>;b++){
00380 printf(<span class="stringliteral">"\t\tres %d alt %d : %20.15e %20.15e %20.15e\n"</span>,a,b,D[0].M.r[a].rc[b].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo0">i</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>,D[0].<a class="code" href="../../de/da3/structdockinfo.html#dockinfoo18">M</a>.<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo12">r</a>[a].<a class="code" href="../../d0/d7e/structresidue.html#residueo17">rc</a>[b].<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>); 
00381 }
00382 }
00383 }
00384 
00385 <span class="keywordflow">return</span> D;
00386 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Aug 8 10:31:04 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
