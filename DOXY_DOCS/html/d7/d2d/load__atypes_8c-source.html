<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: src/load_atypes.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000002.html">src</a></div>
<h1>load_atypes.c</h1><a href="../../dd/d4e/load__atypes_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">// File load_atypes.c begun on 20071128 by BLFoley</span>
00002 <span class="comment">// Purpose: load database of atom types into atype</span>
00003 <span class="comment">//      substructure within a types superstructure</span>
00004 <span class="comment">// NOTE!  T needs to be initialized -before- calling</span>
00005 <span class="comment">//      this function!</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/dea/mylib_8h.html">mylib.h</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/d14/general_8h.html">general.h</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/de6/molecules_8h.html">molecules.h</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="../../db/d40/declarations_8h.html">declarations.h</a>&gt;</span>
00010 <span class="comment">//#include "../inc/mylib.h"</span>
00011 <span class="comment">//#include "../inc/general.h"</span>
00012 <span class="comment">//#include "../inc/molecules.h"</span>
00013 <span class="comment">//#include "../inc/declarations.h"</span>
00014 
<a name="l00015"></a><a class="code" href="../../dd/d4e/load__atypes_8c.html#a0">00015</a> <span class="keywordtype">void</span> <a class="code" href="../../dd/d4e/load__atypes_8c.html#a0">load_atypes</a>(<a class="code" href="../../dc/d59/structfileset.html">fileset</a> F, <a class="code" href="../../d5/de2/structtypes.html">types</a> *T){
00016 <span class="keywordtype">char</span> <a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>[10001],*entry;
00017 <span class="keywordtype">int</span> test=0,la=0,numbnd=0;
00018 F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>=<a class="code" href="../../df/da0/group__FILE__UTILS.html#ga1">myfreopen</a>(F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>,<span class="stringliteral">"r"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>); <span class="comment">// don't depend on calling function to have opened</span>
00019 <span class="keywordflow">while</span>(fgets(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,10000,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto1">F</a>)!=NULL){<span class="comment">// while not end of file</span>
00020         <span class="keywordflow">if</span>(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>[0]!=<span class="charliteral">'#'</span>){<span class="comment">//check that the line does not start with a hash </span>
00021                 <span class="keywordflow">if</span>(strchr(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,EOF)!=NULL){<a class="code" href="../../df/da0/group__FILE__UTILS.html#ga2">read_eek</a>(<span class="stringliteral">"EOF"</span>,F.<a class="code" href="../../dc/d59/structfileset.html#fileseto0">N</a>);}
00022                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>++;<span class="comment">// increment and allocate</span>
00023                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>=(<a class="code" href="../../dc/d7a/structatype.html">atype</a>*)realloc(T[0].a,T[0].na*<span class="keyword">sizeof</span>(<a class="code" href="../../dc/d7a/structatype.html">atype</a>));
00024                 <span class="comment">// read data into structure by splitting on the : token</span>
00025                 <span class="comment">//strcpy(entry,strtok(line,":")); // get atomic number</span>
00026                 test=sscanf(strtok(<a class="code" href="../../d7/d40/load__pdb_8h.html#a5">line</a>,<span class="stringliteral">":"</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].n);
00027                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading atomic number"</span>);}
00028                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo1">N</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get atom name</span>
00029                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo2">NT</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get element name</span>
00030                 <span class="comment">//strcpy(entry,strtok(NULL,":")); // get mass</span>
00031                 test=sscanf(strtok(NULL,<span class="stringliteral">":"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].m);
00032                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading atomic mass"</span>);}
00033                 T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo4">desc</a>=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get description </span>
00034                 entry=strdup(strtok(NULL,<span class="stringliteral">":"</span>)); <span class="comment">// get bonding info </span>
00035                 test=sscanf(strtok(NULL,<span class="stringliteral">":"</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].nlp);<span class="comment">// get number lone pairs</span>
00036                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading number of lone pairs"</span>);}
00037                 <span class="comment">// split bonding info</span>
00038                 <span class="keywordflow">if</span>(strchr(entry,<span class="charliteral">'('</span>)==NULL){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: bonding field does not contain bond orders"</span>);}
00039                 test=sscanf(strtok(entry,<span class="stringliteral">"("</span>),<span class="stringliteral">"%d"</span>,&amp;T[0].a[T[0].na-1].nb);<span class="comment">// get number typical bonds</span>
00040                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading number of typical bonds"</span>);}
00041                 numbnd=T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo5">nb</a>;
00042                 <span class="keywordflow">if</span>(numbnd==0){
00043                         numbnd=1;
00044                         T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>=(<span class="keywordtype">double</span>*)calloc(1,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00045                         test=sscanf(strtok(NULL,<span class="stringliteral">",)"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].bo[0]);<span class="comment">// get bond order</span>
00046                         <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading bond order"</span>);}
00047                         <span class="keywordflow">if</span>(T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>[0]!=0) T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo5">nb</a>=-1;
00048                         }
00049                 <span class="keywordflow">else</span>{
00050                         T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso1">a</a>[T[0].<a class="code" href="../../d5/de2/structtypes.html#typeso0">na</a>-1].<a class="code" href="../../dc/d7a/structatype.html#atypeo6">bo</a>=(<span class="keywordtype">double</span>*)calloc(numbnd,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00051                         <span class="keywordflow">for</span>(la=0;la&lt;numbnd;la++){
00052                                 test=sscanf(strtok(NULL,<span class="stringliteral">",)"</span>),<span class="stringliteral">"%lf"</span>,&amp;T[0].a[T[0].na-1].bo[la]);<span class="comment">// get bond order</span>
00053                                 <span class="keywordflow">if</span>(test!=1){<a class="code" href="../../d9/d66/mywhine_8c.html#a0">mywhine</a>(<span class="stringliteral">"load_atypes: error reading bond order"</span>);}
00054                                 } 
00055                         }
00056                 } <span class="comment">// close if line is not a comment</span>
00057         }<span class="comment">// close while not EOF</span>
00058 <span class="comment">// return; </span>
00059 <span class="keywordflow">return</span>;
00060 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Aug 8 10:31:04 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
