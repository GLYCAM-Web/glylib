<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>GLYLIB: src/add_to_moiety_selection.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_4c50504df4ef4681d4a5a0710190c908.html">src</a>
  </div>
</div>
<div class="contents">
<h1>add_to_moiety_selection.c</h1><a href="../../d5/d10/add__to__moiety__selection_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00086"></a>00086 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/dea/mylib_8h.html" title="generic header file that loads utilities often needed by programmers">mylib.h</a>&gt;</span>
<a name="l00087"></a>00087 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/de6/molecules_8h.html">molecules.h</a>&gt;</span>
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="../../d5/d10/add__to__moiety__selection_8c.html#e2f4892b279528b87b2fceb2af71e39a">00089</a> <span class="keywordtype">void</span> <a class="code" href="../../d5/d10/add__to__moiety__selection_8c.html#e2f4892b279528b87b2fceb2af71e39a">add_to_moiety_selection</a>(<a class="code" href="../../d0/d18/structmoiety__selection.html">moiety_selection</a> *M, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">SEL</span>){
<a name="l00090"></a>00090 <span class="keywordtype">int</span>     aa=0, 
<a name="l00091"></a>00091         ab=0, 
<a name="l00092"></a>00092         ac=0, 
<a name="l00093"></a>00093         posneg=0, 
<a name="l00094"></a>00094         number=0; 
<a name="l00095"></a>00095 <span class="keywordtype">char</span>    *tp, 
<a name="l00096"></a>00096         *ts, 
<a name="l00097"></a>00097         *S, 
<a name="l00098"></a>00098         *<span class="keyword">class</span>, 
<a name="l00099"></a>00099         *des, 
<a name="l00100"></a>00100         **d; 
<a name="l00101"></a>00101 
<a name="l00103"></a>00103 S=strdup(<a class="code" href="../../d1/d34/gly__codeutils_8h.html#f790a45562b331054052f3280f65dea9">prune_string_whitespace</a>(<span class="keywordtype">SEL</span>));
<a name="l00104"></a>00104 
<a name="l00106"></a>00106 tp=S; <span class="comment">// use a temporary pointer (tp) to move around in S.</span>
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="comment">// Get Integer</span>
<a name="l00109"></a>00109 aa=strcspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>); 
<a name="l00110"></a>00110 <span class="keywordflow">if</span>(aa==0){<span class="keywordflow">return</span>;} 
<a name="l00111"></a>00111 ts=(<span class="keywordtype">char</span>*)calloc(aa+1,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00112"></a>00112 strncpy(ts,tp,aa); 
<a name="l00113"></a>00113 ts[aa]=<span class="charliteral">'\0'</span>;
<a name="l00114"></a>00114 ab=sscanf(ts,<span class="stringliteral">"%d"</span>,&amp;number); 
<a name="l00115"></a>00115 <span class="keywordflow">if</span>(ab==0){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: Initial item in SEL not an integer"</span>);}
<a name="l00116"></a>00116 free(ts);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">// Get Class</span>
<a name="l00119"></a>00119 tp+=aa; <span class="comment">// move the pointer past the first item</span>
<a name="l00120"></a>00120 aa=strspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>);
<a name="l00121"></a>00121 tp+=aa; <span class="comment">// move past the whitespace</span>
<a name="l00122"></a>00122 aa=strcspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>); 
<a name="l00123"></a>00123 <span class="keyword">class</span>=(<span class="keywordtype">char</span>*)calloc((aa+1),<span class="keyword">sizeof</span>(char));
<a name="l00124"></a>00124 strncpy(<span class="keyword">class</span>,tp,aa); 
<a name="l00125"></a>00125 <span class="keyword">class</span>[aa]=<span class="charliteral">'\0'</span>;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">// Get Designation</span>
<a name="l00128"></a>00128 tp+=aa; <span class="comment">// move the pointer past the second item</span>
<a name="l00129"></a>00129 aa=strspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>);
<a name="l00130"></a>00130 tp+=aa; <span class="comment">// move past the whitespace</span>
<a name="l00131"></a>00131 aa=strcspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>); 
<a name="l00132"></a>00132 des=(<span class="keywordtype">char</span>*)calloc((aa+1),<span class="keyword">sizeof</span>(char));
<a name="l00133"></a>00133 strncpy(des,tp,aa); 
<a name="l00134"></a>00134 des[aa]=<span class="charliteral">'\0'</span>;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">// See if there is an Optional -NOT-</span>
<a name="l00137"></a>00137 ts=strstr(tp,<span class="stringliteral">"-NOT-"</span>); 
<a name="l00138"></a>00138 <span class="keywordflow">if</span>(ts!=NULL){ <span class="comment">// if a not entry was found</span>
<a name="l00139"></a>00139         posneg=-1;
<a name="l00140"></a>00140         tp=ts+5; <span class="comment">// move the tp pointer past the "-NOT-"</span>
<a name="l00141"></a>00141         }
<a name="l00142"></a>00142 <span class="keywordflow">else</span>{posneg=+1;}
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="keywordflow">if</span>((M[0].posneg!=0)&amp;&amp;(M[0].posneg!=posneg)){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: positive/negative mismatch with SEL and M."</span>);}
<a name="l00145"></a>00145 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#7a98a2d199872cf13114f6790666725d" title="Is this a positive (1), negative (-1) or brand new (0) selection set?">posneg</a>=posneg; <span class="comment">// In case it was zero</span>
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 <span class="comment">// separate the designation_list by scanning for non-whitespace</span>
<a name="l00148"></a>00148 d=(<span class="keywordtype">char</span>**)calloc(number,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00149"></a>00149 <span class="keywordflow">for</span>(ab=0;ab&lt;number;ab++){
<a name="l00150"></a>00150         aa=strspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>);
<a name="l00151"></a>00151         tp+=aa; <span class="comment">// move past the whitespace</span>
<a name="l00152"></a>00152         aa=strcspn(tp,<span class="stringliteral">" \t\n\v\r\f"</span>); 
<a name="l00153"></a>00153         d[ab]=(<span class="keywordtype">char</span>*)calloc((aa+1),<span class="keyword">sizeof</span>(char));
<a name="l00154"></a>00154         strncpy(d[ab],tp,aa); 
<a name="l00155"></a>00155         d[ab][aa]=<span class="charliteral">'\0'</span>; 
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="comment">// add the string entries to the appropriate parts of the moiety_selection</span>
<a name="l00159"></a>00159 <span class="keywordflow">switch</span>(<span class="keyword">class</span>[0]){ 
<a name="l00160"></a>00160         <span class="keywordflow">case</span> <span class="charliteral">'M'</span>:
<a name="l00161"></a>00161         <span class="keywordflow">case</span> <span class="charliteral">'m'</span>:
<a name="l00162"></a>00162                 <span class="keywordflow">switch</span>(des[1]){ 
<a name="l00163"></a>00163                         <span class="keywordflow">case</span> <span class="charliteral">'A'</span>:
<a name="l00164"></a>00164                         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
<a name="l00165"></a>00165                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#435069295c17da60e5cf72b953dd5cce">nmN</a>;
<a name="l00166"></a>00166                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#435069295c17da60e5cf72b953dd5cce">nmN</a>+=number;
<a name="l00167"></a>00167                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#70f68f83019c4bd718dba83903cdbb10" title="nmN names">mN</a>=(<span class="keywordtype">char</span>**)realloc(M[0].mN,M[0].nmN*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00168"></a>00168                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#70f68f83019c4bd718dba83903cdbb10" title="nmN names">mN</a>[aa+ab]=strdup(d[aa]);}
<a name="l00169"></a>00169                                 <span class="keywordflow">break</span>;
<a name="l00170"></a>00170                         <span class="keywordflow">case</span> <span class="charliteral">'U'</span>:
<a name="l00171"></a>00171                         <span class="keywordflow">case</span> <span class="charliteral">'u'</span>:
<a name="l00172"></a>00172                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#29d05ef451957ec55a6a67566fac4f99">nmn</a>;
<a name="l00173"></a>00173                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#29d05ef451957ec55a6a67566fac4f99">nmn</a>+=number;
<a name="l00174"></a>00174                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#6a728d449aacbab1c4f61d112f5d4d4e">mn</a>=(<span class="keywordtype">int</span>*)realloc(M[0].mn,M[0].nmn*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00175"></a>00175                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){ac=sscanf(d[aa],<span class="stringliteral">"%d"</span>,&amp;M[0].mn[aa+ab]);
<a name="l00176"></a>00176                                         <span class="keywordflow">if</span>(ac!=1){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: expected integer for des-number, got something else"</span>);}}
<a name="l00177"></a>00177                                 <span class="keywordflow">break</span>;
<a name="l00178"></a>00178                         <span class="keywordflow">case</span> <span class="charliteral">'N'</span>:
<a name="l00179"></a>00179                         <span class="keywordflow">case</span> <span class="charliteral">'n'</span>:
<a name="l00180"></a>00180                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#dd99590fe49b69d66fc28dae4c927577">nmi</a>;
<a name="l00181"></a>00181                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#dd99590fe49b69d66fc28dae4c927577">nmi</a>+=number;
<a name="l00182"></a>00182                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#525765145d8aa27314ae9531230cb9fc">mi</a>=(<span class="keywordtype">int</span>*)realloc(M[0].mi,M[0].nmi*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00183"></a>00183                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){ac=sscanf(d[aa],<span class="stringliteral">"%d"</span>,&amp;M[0].mi[aa+ab]);
<a name="l00184"></a>00184                                         <span class="keywordflow">if</span>(ac!=1){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: expected integer for index, got something else"</span>);}}
<a name="l00185"></a>00185                                 <span class="keywordflow">break</span>;
<a name="l00186"></a>00186                         <span class="keywordflow">default</span>:
<a name="l00187"></a>00187                                 <a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: unrecognized moiety-designation"</span>);
<a name="l00188"></a>00188                         }
<a name="l00189"></a>00189                 <span class="keywordflow">break</span>;
<a name="l00190"></a>00190         <span class="keywordflow">case</span> <span class="charliteral">'R'</span>:
<a name="l00191"></a>00191         <span class="keywordflow">case</span> <span class="charliteral">'r'</span>: 
<a name="l00192"></a>00192                 <span class="keywordflow">switch</span>(des[1]){ 
<a name="l00193"></a>00193                         <span class="keywordflow">case</span> <span class="charliteral">'A'</span>:
<a name="l00194"></a>00194                         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
<a name="l00195"></a>00195                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#39fd8abf41b52321f78ac7c94dbf33e6">nrN</a>;
<a name="l00196"></a>00196                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#39fd8abf41b52321f78ac7c94dbf33e6">nrN</a>+=number;
<a name="l00197"></a>00197                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#c09100a0169f6547204e46b8e8d6e523" title="nrN names">rN</a>=(<span class="keywordtype">char</span>**)realloc(M[0].rN,M[0].nrN*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00198"></a>00198                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#c09100a0169f6547204e46b8e8d6e523" title="nrN names">rN</a>[aa+ab]=strdup(d[aa]);}
<a name="l00199"></a>00199                                 <span class="keywordflow">break</span>;
<a name="l00200"></a>00200                         <span class="keywordflow">case</span> <span class="charliteral">'U'</span>:
<a name="l00201"></a>00201                         <span class="keywordflow">case</span> <span class="charliteral">'u'</span>:
<a name="l00202"></a>00202                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#f3e2ac5e987e59bf6f4723454ba7d8ae">nrn</a>;
<a name="l00203"></a>00203                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#f3e2ac5e987e59bf6f4723454ba7d8ae">nrn</a>+=number;
<a name="l00204"></a>00204                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#884bdd8561dccfa8f90f2d5ea4ebc36b">rn</a>=(<span class="keywordtype">int</span>*)realloc(M[0].rn,M[0].nrn*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00205"></a>00205                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){ac=sscanf(d[aa],<span class="stringliteral">"%d"</span>,&amp;M[0].rn[aa+ab]);
<a name="l00206"></a>00206                                         <span class="keywordflow">if</span>(ac!=1){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: expected integer for des-number, got something else"</span>);}}
<a name="l00207"></a>00207                                 <span class="keywordflow">break</span>;
<a name="l00208"></a>00208                         <span class="keywordflow">case</span> <span class="charliteral">'N'</span>:
<a name="l00209"></a>00209                         <span class="keywordflow">case</span> <span class="charliteral">'n'</span>:
<a name="l00210"></a>00210                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#017218e2b1ffc05476090f89b2805fbb">nri</a>;
<a name="l00211"></a>00211                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#017218e2b1ffc05476090f89b2805fbb">nri</a>+=number;
<a name="l00212"></a>00212                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#a02841f40c4a60dc8cb03d47426ec51f" title="# of residue names, numbers &amp;amp; indicies, nrn numbers and nri indices">ri</a>=(<span class="keywordtype">int</span>*)realloc(M[0].ri,M[0].nri*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00213"></a>00213                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){ac=sscanf(d[aa],<span class="stringliteral">"%d"</span>,&amp;M[0].ri[aa+ab]);
<a name="l00214"></a>00214                                         <span class="keywordflow">if</span>(ac!=1){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: expected integer for index, got something else"</span>);}}
<a name="l00215"></a>00215                                 <span class="keywordflow">break</span>;
<a name="l00216"></a>00216                         <span class="keywordflow">default</span>:
<a name="l00217"></a>00217                                 <a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: unrecognized moiety-designation"</span>);
<a name="l00218"></a>00218                         }
<a name="l00219"></a>00219                 <span class="keywordflow">break</span>;
<a name="l00220"></a>00220         <span class="keywordflow">case</span> <span class="charliteral">'A'</span>:
<a name="l00221"></a>00221         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>: 
<a name="l00222"></a>00222                 <span class="keywordflow">switch</span>(des[1]){ 
<a name="l00223"></a>00223                         <span class="keywordflow">case</span> <span class="charliteral">'A'</span>:
<a name="l00224"></a>00224                         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
<a name="l00225"></a>00225                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#30e9c0bc828b2235b6a6c72ad9e51f5f">naN</a>;
<a name="l00226"></a>00226                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#30e9c0bc828b2235b6a6c72ad9e51f5f">naN</a>+=number;
<a name="l00227"></a>00227                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#d59182440f58d7a080effa9553d9cf87" title="naN names">aN</a>=(<span class="keywordtype">char</span>**)realloc(M[0].aN,M[0].naN*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00228"></a>00228                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#d59182440f58d7a080effa9553d9cf87" title="naN names">aN</a>[aa+ab]=strdup(d[aa]);}
<a name="l00229"></a>00229                                 <span class="keywordflow">break</span>;
<a name="l00230"></a>00230                         <span class="keywordflow">case</span> <span class="charliteral">'U'</span>:
<a name="l00231"></a>00231                         <span class="keywordflow">case</span> <span class="charliteral">'u'</span>:
<a name="l00232"></a>00232                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#66896910787ff3e34af1571bab7dacaf">nan</a>;
<a name="l00233"></a>00233                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#66896910787ff3e34af1571bab7dacaf">nan</a>+=number;
<a name="l00234"></a>00234                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#2f5f40123092c727eabe8059fca08bfa">an</a>=(<span class="keywordtype">int</span>*)realloc(M[0].an,M[0].nan*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00235"></a>00235                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){ac=sscanf(d[aa],<span class="stringliteral">"%d"</span>,&amp;M[0].an[aa+ab]);
<a name="l00236"></a>00236                                         <span class="keywordflow">if</span>(ac!=1){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: expected integer for des-number, got something else"</span>);}}
<a name="l00237"></a>00237                                 <span class="keywordflow">break</span>;
<a name="l00238"></a>00238                         <span class="keywordflow">case</span> <span class="charliteral">'N'</span>:
<a name="l00239"></a>00239                         <span class="keywordflow">case</span> <span class="charliteral">'n'</span>:
<a name="l00240"></a>00240                                 ab=M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#295a757e0448f66853be485cf5a50695">nai</a>;
<a name="l00241"></a>00241                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#295a757e0448f66853be485cf5a50695">nai</a>+=number;
<a name="l00242"></a>00242                                 M[0].<a class="code" href="../../d0/d18/structmoiety__selection.html#d1baf37ce129b978d8b02611e5de58c9" title="# of atom names, numbers &amp;amp; indicies, nan numbers and nai indices">ai</a>=(<span class="keywordtype">int</span>*)realloc(M[0].ai,M[0].nai*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00243"></a>00243                                 <span class="keywordflow">for</span>(aa=0;aa&lt;number;aa++){ac=sscanf(d[aa],<span class="stringliteral">"%d"</span>,&amp;M[0].ai[aa+ab]);
<a name="l00244"></a>00244                                         <span class="keywordflow">if</span>(ac!=1){<a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: expected integer for index, got something else"</span>);}}
<a name="l00245"></a>00245                                 <span class="keywordflow">break</span>;
<a name="l00246"></a>00246                         <span class="keywordflow">default</span>:
<a name="l00247"></a>00247                                 <a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: unrecognized moiety-designation"</span>);
<a name="l00248"></a>00248                         }
<a name="l00249"></a>00249                 <span class="keywordflow">break</span>;
<a name="l00250"></a>00250         <span class="keywordflow">default</span>:
<a name="l00251"></a>00251                 <a class="code" href="../../d1/d34/gly__codeutils_8h.html#adce93feeb2a291f0fef33ffc4a8509d" title="Prints error message and exits(1).">mywhine</a>(<span class="stringliteral">"add_to_moiety_selection: unrecognized moiety-size-class"</span>);
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="keywordflow">return</span>;
<a name="l00255"></a>00255 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Oct 7 18:13:37 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
