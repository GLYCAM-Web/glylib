<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: src/amber_prmtop_init.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000002.html">src</a></div>
<h1>amber_prmtop_init.c</h1><a href="../../d0/d92/amber__prmtop__init_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/* File amber_prmtop_init.c begun on or around 20080424 by BLFoley</span>
00002 <span class="comment">        Purpose: initialize structure info for amber prmtop file read */</span>
00003 <span class="comment">//#include "mylib.h"</span>
00004 <span class="preprocessor">#include "<a class="code" href="../../d6/d78/amber__prmtop_8h.html">AMBER/amber_prmtop.h</a>"</span>
00005 <span class="comment">//#include "amber_prmtop_structs.h"</span>
00006 
<a name="l00007"></a><a class="code" href="../../d0/d92/amber__prmtop__init_8c.html#a0">00007</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d92/amber__prmtop__init_8c.html#a0">amber_prmtop_init</a>(<a class="code" href="../../de/de7/structamber__prmtop.html">amber_prmtop</a> *P){
00008 <span class="keywordtype">int</span> a=0,b=0,c=0;
00009 <span class="keywordtype">char</span> *s,*sp,**p1,**p2,*FLG,*FOR; <span class="comment">// strings</span>
00010 
00011 <span class="comment">// Set some initial values, just 'cause</span>
00012 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo14">NATOM</a>  =0; <span class="comment">// total number of atoms </span>
00013 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo15">NTYPES</a> =0; <span class="comment">// total number of distinct atom types</span>
00014 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo16">NBONH</a>  =0; <span class="comment">// number of bonds containing hydrogen</span>
00015 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo17">MBONA</a>  =0; <span class="comment">// number of bonds not containing hydrogen</span>
00016 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo18">NTHETH</a> =0; <span class="comment">// number of angles containing hydrogen</span>
00017 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo19">MTHETA</a> =0; <span class="comment">// number of angles not containing hydrogen</span>
00018 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo20">NPHIH</a>  =0; <span class="comment">// number of dihedrals containing hydrogen</span>
00019 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo21">MPHIA</a>  =0; <span class="comment">// number of dihedrals not containing hydrogen</span>
00020 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo22">NHPARM</a> =0; <span class="comment">// currently not used</span>
00021 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo23">NPARM</a>  =0; <span class="comment">// currently not used</span>
00022 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo24">NEXT</a>   =0; <span class="comment">// number of excluded atoms</span>
00023 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo25">NRES</a>   =0; <span class="comment">// number of residues</span>
00024 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo26">NBONA</a>  =0; <span class="comment">// MBONA + number of constraint bonds</span>
00025 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo27">NTHETA</a> =0; <span class="comment">// MTHETA + number of constraint angles</span>
00026 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo28">NPHIA</a>  =0; <span class="comment">// MPHIA + number of constraint dihedrals</span>
00027 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo29">NUMBND</a> =0; <span class="comment">// number of unique bond types</span>
00028 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo30">NUMANG</a> =0; <span class="comment">// number of unique angle types</span>
00029 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo31">NPTRA</a>  =0; <span class="comment">// number of unique dihedral types</span>
00030 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo32">NATYP</a>  =0; <span class="comment">// number of atom types in parameter file, see SOLTY below</span>
00031 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo33">NPHB</a>   =0; <span class="comment">// number of distinct 10-12 hydrogen bond pair types</span>
00032 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo34">IFPERT</a> =0; <span class="comment">// set to 1 if perturbation info is to be read in</span>
00033 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo35">NBPER</a>  =0; <span class="comment">// number of bonds to be perturbed</span>
00034 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo36">NGPER</a>  =0; <span class="comment">// number of angles to be perturbed</span>
00035 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo37">NDPER</a>  =0; <span class="comment">// number of dihedrals to be perturbed</span>
00036 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo38">MBPER</a>  =0; <span class="comment">// number of bonds with atoms completely in perturbed group</span>
00037 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo39">MGPER</a>  =0; <span class="comment">// number of angles with atoms completely in perturbed group</span>
00038 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo40">MDPER</a>  =0; <span class="comment">// number of dihedrals with atoms completely in perturbed groups</span>
00039 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo41">IFBOX</a>  =0; <span class="comment">// set to 1 if standard periodic box, 2 when truncated octahedral</span>
00040 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo42">NMXRS</a>  =0; <span class="comment">// number of atoms in the largest residue</span>
00041 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo43">IFCAP</a>  =0; <span class="comment">// set to 1 if the CAP option from edit was specified</span>
00042 <span class="comment">//</span>
00043 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo2">nS</a>=0;
00044 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo5">nSS</a>=0;
00045 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo7">nES</a>=0;
00046 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo9">nFF</a>=0;
00047 
00048 <span class="comment">// Set integer values for strings in AMBER_PRMTOP_FLAGS </span>
00049 <span class="comment">// Set number of chars per entry from AMBER_PRMTOP_FORMATS</span>
00050 <span class="comment">// To do this...</span>
00051 <span class="comment">//      see how much memory we need -- </span>
00052 <span class="comment">//      loop through AMBER_PRMTOP_FLAGS and count fields between spaces</span>
00053 a=0;
00054 b=1; <span class="comment">// will need one more field than # of spaces</span>
00055 <span class="keywordflow">while</span>(<a class="code" href="../../d4/d08/amber__prmtop__structs_8h.html#a0">AMBER_PRMTOP_FLAGS</a>[a]!=<span class="charliteral">'\0'</span>){
00056         <span class="keywordflow">if</span>(<a class="code" href="../../d4/d08/amber__prmtop__structs_8h.html#a0">AMBER_PRMTOP_FLAGS</a>[a]==<span class="charliteral">' '</span>) b++;
00057         a++;}
00058 <span class="comment">// check the FORMATS definition, just 'cause</span>
00059 a=0;
00060 c=1; <span class="comment">// will need one more field than # of spaces </span>
00061 <span class="keywordflow">while</span>(<a class="code" href="../../d4/d08/amber__prmtop__structs_8h.html#a1">AMBER_PRMTOP_FORMATS</a>[a]!=<span class="charliteral">'\0'</span>){
00062         <span class="keywordflow">if</span>(<a class="code" href="../../d4/d08/amber__prmtop__structs_8h.html#a1">AMBER_PRMTOP_FORMATS</a>[a]==<span class="charliteral">' '</span>) c++;
00063         a++;}
00064 <span class="keywordflow">if</span>(b!=c){
00065         printf(<span class="stringliteral">"b is %d ; c is %d \n"</span>,b,c);
00066         printf(<span class="stringliteral">"Mismatch in AMBER FLAGS and FORMATS as defined in amber_prmtop_structs.h. Exiting.\n"</span>); 
00067         exit(1);}
00068 <span class="comment">//      allocate memory in the amber_prmtop structure</span>
00069 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo11">FLAGS</a>=(<span class="keywordtype">char</span>**)calloc(b,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
00070 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo10">FORMATS</a>=(<span class="keywordtype">int</span>*)calloc(b,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
00071 <span class="comment">// Use strtok to split the flag strings and get ascii integer variants</span>
00072 <span class="comment">// save each flag as the integer value of the string</span>
00073 FLG=strdup(<a class="code" href="../../d4/d08/amber__prmtop__structs_8h.html#a0">AMBER_PRMTOP_FLAGS</a>);
00074 P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo11">FLAGS</a>[0]=strdup(strtok(FLG,<span class="stringliteral">" "</span>));
00075 <span class="keywordflow">for</span>(a=1;a&lt;b;a++){P[0].<a class="code" href="../../de/de7/structamber__prmtop.html#amber__prmtopo11">FLAGS</a>[a]=strdup(strtok(NULL,<span class="stringliteral">" "</span>));}
00076 <span class="comment">// now parse the format strings</span>
00077 <span class="comment">// save each format as the number of characters allocated for each datum</span>
00078 FOR=strdup(<a class="code" href="../../d4/d08/amber__prmtop__structs_8h.html#a1">AMBER_PRMTOP_FORMATS</a>);
00079 p1=&amp;FOR;
00080 s=strdup(strtok_r(FOR,<span class="stringliteral">" "</span>,p1)); <span class="comment">// get a format string</span>
00081 p2=&amp;s;
00082 sp=strdup(strtok_r(s,<span class="stringliteral">"aAiIfFeE"</span>,p2)); <span class="comment">// find the format identifier</span>
00083 sp=strdup(strtok_r(NULL,<span class="stringliteral">"."</span>,p2)); <span class="comment">// information after, but before any periods</span>
00084 <span class="keywordflow">if</span>((strchr(sp,<span class="charliteral">'S'</span>)!=NULL)||(strchr(sp,<span class="charliteral">'N'</span>)!=NULL)){sp[0]=<span class="charliteral">'0'</span>;} <span class="comment">// EN or ES</span>
00085 sscanf(sp,<span class="stringliteral">"%d"</span>,&amp;P[0].FORMATS[0]);
00086 <span class="keywordflow">for</span>(a=1;a&lt;b;a++){
00087         s=strdup(strtok_r(NULL,<span class="stringliteral">" "</span>,p1)); <span class="comment">// get a format string</span>
00088         sp=strdup(strtok_r(s,<span class="stringliteral">"aAiIfFeE"</span>,p2)); <span class="comment">// find the format identifier</span>
00089         sp=strdup(strtok_r(NULL,<span class="stringliteral">"."</span>,p2)); <span class="comment">// after, but before any periods</span>
00090         <span class="keywordflow">if</span>((strchr(sp,<span class="charliteral">'S'</span>)!=NULL)||(strchr(sp,<span class="charliteral">'N'</span>)!=NULL)){sp[0]=<span class="charliteral">'0'</span>;} <span class="comment">// EN or ES</span>
00091         sscanf(sp,<span class="stringliteral">"%d"</span>,&amp;P[0].FORMATS[a]); 
00092         }
00093 <span class="keywordflow">return</span>;
00094 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jul 21 18:20:33 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
