<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GLYLIB: src/outputPDB.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="../../dir_000002.html">src</a></div>
<h1>outputPDB.c</h1><a href="../../d8/dd9/outputPDB_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/* Author: Michael Tessier*/</span>
00002 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/de6/molecules_8h.html">molecules.h</a>&gt;</span>
00003 <span class="preprocessor">#include &lt;<a class="code" href="../../dd/dea/mylib_8h.html">mylib.h</a>&gt;</span>
00004 <span class="comment">//#include "../inc/molecules.h"</span>
00005 <span class="comment">//#include "../inc/mylib.h"</span>
00006 <span class="comment">//</span>
<a name="l00007"></a><a class="code" href="../../d8/dd9/outputPDB_8c.html#a0">00007</a> <span class="preprocessor">#define TRUE  1</span>
<a name="l00008"></a><a class="code" href="../../d8/dd9/outputPDB_8c.html#a1">00008</a> <span class="preprocessor"></span><span class="preprocessor">#define FALSE 0</span>
00009 <span class="preprocessor"></span>
<a name="l00010"></a><a class="code" href="../../d8/dd9/outputPDB_8c.html#a2">00010</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/dd9/outputPDB_8c.html#a2">outputMolPDB</a>(<a class="code" href="../../dc/d7f/structmolecule.html">molecule</a>* mol, <span class="keywordtype">char</span>* file_name)
00011 {
00012  <span class="comment">//Tells the user what's going on</span>
00013  printf(<span class="stringliteral">"Writting file: %s...\n"</span>,file_name);
00014  FILE* file;
00015  <span class="keywordtype">char</span> current_line[80] = <span class="stringliteral">""</span>; <span class="keywordtype">char</span> temporary[40] = <span class="stringliteral">""</span>;
00016  <span class="keywordtype">char</span>* curLine = current_line; <span class="keywordtype">char</span>* temp = temporary;
00017  <span class="keywordtype">char</span>* resName; <span class="keywordtype">char</span>* atmName;
00018  <span class="keywordtype">int</span> i; <span class="keywordtype">int</span> j; <span class="keywordtype">int</span> atmTot; <span class="keywordtype">int</span> resNum; <span class="keywordtype">int</span> resTot = (*mol).nr;
00019  <a class="code" href="../../da/d81/structatom.html">atom</a> curAtm;
00020  file = <a class="code" href="../../df/da0/group__FILE__UTILS.html#ga0">myfopen</a>(file_name,<span class="stringliteral">"w"</span>);
00021 
00022  <span class="keywordflow">for</span>(i = 0; i &lt; resTot; i++)
00023  {
00024   resName = (*((*mol).r+i)).N;
00025   resNum = (*((*mol).r+i)).n;
00026   atmTot = (*((*mol).r+i)).na;
00027   <span class="keywordflow">for</span>(j = 0; j &lt; atmTot; j++)
00028   {
00029    curAtm = (*((*((*mol).r+i)).a+j));
00030    atmName = curAtm.<a class="code" href="../../da/d81/structatom.html#atomo1">N</a>;
00031    strcpy(curLine,<span class="stringliteral">""</span>);
00032    strcat(curLine,<span class="stringliteral">"ATOM"</span>);
00033 
00034    sprintf(temp,<span class="stringliteral">"%d"</span>, curAtm.<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>);
00035    <span class="comment">//Based on how large the atom # is, depends on the # of spaces</span>
00036    strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),7));
00037    <span class="comment">//"ATOM atom# atom_name"</span>
00038    sprintf(temp,<span class="stringliteral">"%d  %s"</span>, curAtm.<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>, atmName);
00039    strcat(curLine,temp);
00040    
00041    <span class="comment">//Based on how many char are in the residue name, "   " spaces </span>
00042    strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(atmName),4));
00043    <span class="comment">//"ATOM atom# atom_name res_name"</span>
00044    strcat(curLine,resName);
00045    
00046    sprintf(temp,<span class="stringliteral">"%d"</span>,resNum);
00047    <span class="comment">//Based on how large the residue # is, "              " spaces</span>
00048    strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),6));
00049    <span class="comment">//"ATOM atom# atom_name res_name res#"</span>
00050    strcat(curLine,temp);
00051    
00052    sprintf(temp,<span class="stringliteral">"%.3lf"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>);
00053    <span class="comment">//Based on how large the x cordinate is, "            " spaces</span>
00054    strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),12));
00055    <span class="comment">//"ATOM atom# atom_name res_name x"</span>
00056    strcat(curLine,temp);
00057 
00058    sprintf(temp,<span class="stringliteral">"%.3lf"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>);
00059    <span class="comment">//Based on how large the y cordinate is, "            " spaces</span>
00060    strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),8));
00061    <span class="comment">//"ATOM atom# atom_name res_name x y"</span>
00062    strcat(curLine,temp);
00063 
00064    sprintf(temp,<span class="stringliteral">"%.3lf"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00065    <span class="comment">//Based on how large the z cordinate is, "            " spaces</span>
00066    strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),8));
00067    <span class="comment">//"ATOM atom# atom_name res_name x y z 1.00 0.00"</span>
00068    sprintf(temp,<span class="stringliteral">"%.3lf  1.00  0.00"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00069    strcat(curLine,temp);
00070 
00071    <span class="comment">//Output the line to the new .pbd file</span>
00072    fprintf(file,<span class="stringliteral">"%s\n"</span>,curLine);
00073   }
00074  }
00075  fclose(file);
00076 }
<a name="l00077"></a><a class="code" href="../../d8/dd9/outputPDB_8c.html#a3">00077</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/dd9/outputPDB_8c.html#a3">outputAsmblPDB</a>(<a class="code" href="../../db/dac/structassembly.html">assembly</a>* asmbl, <span class="keywordtype">char</span>* file_name)
00078 {
00079  <span class="comment">//Tells the user what's going on</span>
00080  printf(<span class="stringliteral">"Writting file: %s...\n"</span>,file_name);
00081  FILE* file;
00082  <span class="keywordtype">char</span> current_line[80] = <span class="stringliteral">""</span>; <span class="keywordtype">char</span> temporary[40] = <span class="stringliteral">""</span>;
00083  <span class="keywordtype">char</span>* curLine = current_line; <span class="keywordtype">char</span>* temp = temporary;
00084  <span class="keywordtype">char</span>* resName; <span class="keywordtype">char</span>* atmName;
00085  <span class="keywordtype">int</span> i,j,k,atmTot,resNum,resTot;
00086  <a class="code" href="../../da/d81/structatom.html">atom</a> curAtm; <a class="code" href="../../dc/d7f/structmolecule.html">molecule</a>* mol;
00087  file = <a class="code" href="../../df/da0/group__FILE__UTILS.html#ga0">myfopen</a>(file_name,<span class="stringliteral">"w"</span>);
00088  <span class="keywordflow">for</span>(k = 0; k &lt; (*asmbl).nm; k++)
00089  {
00090   mol = ((*asmbl).m+k)[0]; <span class="comment">// changed by BLF on 20080622 -- might need revisiting</span>
00091   resTot = (*mol).<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo11">nr</a>;
00092   <span class="keywordflow">for</span>(i = 0; i &lt; resTot; i++)
00093   {
00094    resName = (*((*mol).r+i)).<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo1">N</a>;
00095    resNum = (*((*mol).r+i)).n;
00096    atmTot = (*((*mol).r+i)).<a class="code" href="../../dc/d7f/structmolecule.html#moleculeo8">na</a>;
00097    <span class="keywordflow">for</span>(j = 0; j &lt; atmTot; j++)
00098    {
00099     curAtm = (*((*((*mol).r+i)).a+j));
00100     atmName = curAtm.<a class="code" href="../../da/d81/structatom.html#atomo1">N</a>;
00101     strcpy(curLine,<span class="stringliteral">""</span>);
00102     strcat(curLine,<span class="stringliteral">"ATOM"</span>); 
00103  
00104     sprintf(temp,<span class="stringliteral">"%d"</span>, curAtm.<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>);
00105     <span class="comment">//Based on how large the atom # is, depends on the # of spaces</span>
00106     strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),7));
00107     <span class="comment">//"ATOM atom# atom_name"</span>
00108     sprintf(temp,<span class="stringliteral">"%d  %s"</span>, curAtm.<a class="code" href="../../da/d81/structatom.html#atomo0">n</a>, atmName);
00109     strcat(curLine,temp);
00110     
00111     <span class="comment">//Based on how many char are in the residue name, "   " spaces </span>
00112     strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(atmName),4));
00113     <span class="comment">//"ATOM atom# atom_name res_name"</span>
00114     strcat(curLine,resName);
00115     
00116     sprintf(temp,<span class="stringliteral">"%d"</span>,resNum);
00117     <span class="comment">//Based on how large the residue # is, "              " spaces</span>
00118     strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),6));
00119     <span class="comment">//"ATOM atom# atom_name res_name res#"</span>
00120     strcat(curLine,temp);
00121     
00122     sprintf(temp,<span class="stringliteral">"%.3lf"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do0">i</a>);
00123     <span class="comment">//Based on how large the x cordinate is, "            " spaces</span>
00124     strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),12));
00125     <span class="comment">//"ATOM atom# atom_name res_name x"</span>
00126     strcat(curLine,temp);
00127  
00128     sprintf(temp,<span class="stringliteral">"%.3lf"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do1">j</a>);
00129     <span class="comment">//Based on how large the y cordinate is, "            " spaces</span>
00130     strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),8));
00131     <span class="comment">//"ATOM atom# atom_name res_name x y"</span>
00132     strcat(curLine,temp);
00133 
00134     sprintf(temp,<span class="stringliteral">"%.3lf"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00135     <span class="comment">//Based on how large the z cordinate is, "            " spaces</span>
00136     strcat(curLine,<a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(strlen(temp),8));
00137     <span class="comment">//"ATOM atom# atom_name res_name x y z 1.00 0.00"</span>
00138     sprintf(temp,<span class="stringliteral">"%.3lf  1.00  0.00"</span>,curAtm.<a class="code" href="../../da/d81/structatom.html#atomo11">x</a>.<a class="code" href="../../d8/d31/structcoord__3D.html#coord__3Do2">k</a>);
00139     strcat(curLine,temp);
00140 
00141     <span class="comment">//Output the line to the new .pbd file</span>
00142     fprintf(file,<span class="stringliteral">"%s\n"</span>,curLine);
00143    }
00144   }
00145   fprintf(file,<span class="stringliteral">"TER   \n"</span>);
00146  }
00147  fclose(file);
00148 }
<a name="l00149"></a><a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">00149</a> <span class="keywordtype">char</span>* <a class="code" href="../../d8/dd9/outputPDB_8c.html#a4">spacing</a>(<span class="keywordtype">int</span> strLen, <span class="keywordtype">int</span> totLen)
00150 {
00151  <span class="keywordtype">char</span> returning[15] = <span class="stringliteral">""</span>; <span class="keywordtype">char</span>* ret = returning;
00152  <span class="keywordtype">int</span> i;
00153  <span class="keywordflow">for</span>(i = 0; i &lt; totLen - strLen; i++)
00154   strcat(ret,<span class="stringliteral">" "</span>);
00155  <span class="keywordflow">return</span> ret;
00156 }
00157 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Aug 8 10:31:04 2008 for GLYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
